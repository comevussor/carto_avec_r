<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapitre 2 Cartographie thématique | Cartographie avec R</title>
  <meta name="description" content="Matériel pour le cours de cartographie avec R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapitre 2 Cartographie thématique | Cartographie avec R />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cartomix.png" />
  <meta property="og:description" content="Matériel pour le cours de cartographie avec R" />
  <meta name="github-repo" content="rCarto/carto_avec_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 2 Cartographie thématique | Cartographie avec R />
  
  <meta name="twitter:description" content="Matériel pour le cours de cartographie avec R" />
  <meta name="twitter:image" content="img/cartomix.png" />

<meta name="author" content="banner Timothée Giraud &amp; Hugues Pécout">


<meta name="date" content="2018-12-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chapitre1.html">
<link rel="next" href="chapitre3.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<link href="libs/PopupTable-0.0.1/popup.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cartographie avec R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapitre1.html"><a href="chapitre1.html"><i class="fa fa-check"></i><b>1</b> Les données spatiales</a><ul>
<li class="chapter" data-level="1.1" data-path="chapitre1.html"><a href="chapitre1.html#le-package-sf"><i class="fa fa-check"></i><b>1.1</b> Le package <code>sf</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="chapitre1.html"><a href="chapitre1.html#format-des-objets-spatiaux-sf"><i class="fa fa-check"></i><b>1.1.1</b> Format des objets spatiaux <code>sf</code></a></li>
<li class="chapter" data-level="1.1.2" data-path="chapitre1.html"><a href="chapitre1.html#construction-dun-objet-sf"><i class="fa fa-check"></i><b>1.1.2</b> Construction d’un objet sf</a></li>
<li class="chapter" data-level="1.1.3" data-path="chapitre1.html"><a href="chapitre1.html#import-export"><i class="fa fa-check"></i><b>1.1.3</b> Import / Export</a></li>
<li class="chapter" data-level="1.1.4" data-path="chapitre1.html"><a href="chapitre1.html#affichage-de-donnees"><i class="fa fa-check"></i><b>1.1.4</b> Affichage de données</a></li>
<li class="chapter" data-level="1.1.5" data-path="chapitre1.html"><a href="chapitre1.html#joindre-des-donnees"><i class="fa fa-check"></i><b>1.1.5</b> Joindre des données</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chapitre1.html"><a href="chapitre1.html#les-projections"><i class="fa fa-check"></i><b>1.2</b> Les projections</a></li>
<li class="chapter" data-level="1.3" data-path="chapitre1.html"><a href="chapitre1.html#operations-de-geotraitement"><i class="fa fa-check"></i><b>1.3</b> Opérations de géotraitement</a><ul>
<li class="chapter" data-level="1.3.1" data-path="chapitre1.html"><a href="chapitre1.html#selection-par-attributs"><i class="fa fa-check"></i><b>1.3.1</b> Selection par attributs</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapitre1.html"><a href="chapitre1.html#selection-spatiale"><i class="fa fa-check"></i><b>1.3.2</b> Selection spatiale</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapitre1.html"><a href="chapitre1.html#extraire-des-centroides"><i class="fa fa-check"></i><b>1.3.3</b> Extraire des centroides</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapitre1.html"><a href="chapitre1.html#creer-une-matrice-de-distances"><i class="fa fa-check"></i><b>1.3.4</b> Créer une matrice de distances</a></li>
<li class="chapter" data-level="1.3.5" data-path="chapitre1.html"><a href="chapitre1.html#agreger-des-polygones"><i class="fa fa-check"></i><b>1.3.5</b> Agréger des polygones</a></li>
<li class="chapter" data-level="1.3.6" data-path="chapitre1.html"><a href="chapitre1.html#agreger-des-polygones-en-fonction-dune-variable"><i class="fa fa-check"></i><b>1.3.6</b> Agréger des polygones en fonction d’une variable</a></li>
<li class="chapter" data-level="1.3.7" data-path="chapitre1.html"><a href="chapitre1.html#construire-une-zone-tampon"><i class="fa fa-check"></i><b>1.3.7</b> Construire une zone tampon</a></li>
<li class="chapter" data-level="1.3.8" data-path="chapitre1.html"><a href="chapitre1.html#realiser-une-intersection"><i class="fa fa-check"></i><b>1.3.8</b> Réaliser une intersection</a></li>
<li class="chapter" data-level="1.3.9" data-path="chapitre1.html"><a href="chapitre1.html#compter-des-points-dans-un-polygone"><i class="fa fa-check"></i><b>1.3.9</b> Compter des points dans un polygone</a></li>
<li class="chapter" data-level="1.3.10" data-path="chapitre1.html"><a href="chapitre1.html#construire-des-polygones-de-voronoi"><i class="fa fa-check"></i><b>1.3.10</b> Construire des polygones de Voronoi</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapitre1.html"><a href="chapitre1.html#geocodage-dadresses"><i class="fa fa-check"></i><b>1.4</b> Géocodage d’adresses</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre2.html"><a href="chapitre2.html"><i class="fa fa-check"></i><b>2</b> Cartographie thématique</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre2.html"><a href="chapitre2.html#le-package-cartography"><i class="fa fa-check"></i><b>2.1</b> Le package <code>cartography</code></a></li>
<li class="chapter" data-level="2.2" data-path="chapitre2.html"><a href="chapitre2.html#representations-usuelles"><i class="fa fa-check"></i><b>2.2</b> Représentations usuelles</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-symboles-proportionnels"><i class="fa fa-check"></i><b>2.2.1</b> Carte de symboles proportionnels</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapitre2.html"><a href="chapitre2.html#carte-choroplethe"><i class="fa fa-check"></i><b>2.2.2</b> Carte choroplèthe</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapitre2.html"><a href="chapitre2.html#elements-dhabillage"><i class="fa fa-check"></i><b>2.3</b> Éléments d’habillage</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre2.html"><a href="chapitre2.html#ajuster-les-marges-de-la-figures"><i class="fa fa-check"></i><b>2.3.1</b> Ajuster les marges de la figures</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre2.html"><a href="chapitre2.html#fleche-nord"><i class="fa fa-check"></i><b>2.3.2</b> Flèche nord</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapitre2.html"><a href="chapitre2.html#echelle"><i class="fa fa-check"></i><b>2.3.3</b> Échelle</a></li>
<li class="chapter" data-level="2.3.4" data-path="chapitre2.html"><a href="chapitre2.html#creer-un-effet-crayonne"><i class="fa fa-check"></i><b>2.3.4</b> Créer un effet crayonné</a></li>
<li class="chapter" data-level="2.3.5" data-path="chapitre2.html"><a href="chapitre2.html#ajouter-un-ombrage-a-une-couche"><i class="fa fa-check"></i><b>2.3.5</b> Ajouter un ombrage à une couche</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre2.html"><a href="chapitre2.html#palettes-de-couleurs"><i class="fa fa-check"></i><b>2.4</b> Palettes de couleurs</a></li>
<li class="chapter" data-level="2.5" data-path="chapitre2.html"><a href="chapitre2.html#discretisations"><i class="fa fa-check"></i><b>2.5</b> Discrétisations</a></li>
<li class="chapter" data-level="2.6" data-path="chapitre2.html"><a href="chapitre2.html#combinaisons"><i class="fa fa-check"></i><b>2.6</b> Combinaisons</a></li>
<li class="chapter" data-level="2.7" data-path="chapitre2.html"><a href="chapitre2.html#les-donnees-osm"><i class="fa fa-check"></i><b>2.7</b> Les données OSM</a><ul>
<li class="chapter" data-level="2.7.1" data-path="chapitre2.html"><a href="chapitre2.html#donnees-vectorielles"><i class="fa fa-check"></i><b>2.7.1</b> Données vectorielles</a></li>
<li class="chapter" data-level="2.7.2" data-path="chapitre2.html"><a href="chapitre2.html#donnees-raster"><i class="fa fa-check"></i><b>2.7.2</b> Données raster</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="chapitre2.html"><a href="chapitre2.html#creation-de-cartons"><i class="fa fa-check"></i><b>2.8</b> Création de cartons</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre3.html"><a href="chapitre3.html"><i class="fa fa-check"></i><b>3</b> Cartographie thématique avancée</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre3.html"><a href="chapitre3.html#cartographie-interactive"><i class="fa fa-check"></i><b>3.1</b> Cartographie interactive</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes"><i class="fa fa-check"></i><b>3.2</b> Les cartogrammes</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-de-dorling"><i class="fa fa-check"></i><b>3.2.1</b> Les cartogrammes de Dorling</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-non-continus"><i class="fa fa-check"></i><b>3.2.2</b> Les cartogrammes non continus</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-continus"><i class="fa fa-check"></i><b>3.2.3</b> Les cartogrammes continus</a></li>
<li class="chapter" data-level="3.2.4" data-path="chapitre3.html"><a href="chapitre3.html#forces-et-faiblesses-des-cartogrammes"><i class="fa fa-check"></i><b>3.2.4</b> Forces et faiblesses des cartogrammes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapitre3.html"><a href="chapitre3.html#les-grilles-regulieres"><i class="fa fa-check"></i><b>3.3</b> Les grilles régulières</a></li>
<li class="chapter" data-level="3.4" data-path="chapitre3.html"><a href="chapitre3.html#les-cartes-de-discontinuites"><i class="fa fa-check"></i><b>3.4</b> Les cartes de discontinuités</a></li>
<li class="chapter" data-level="3.5" data-path="chapitre3.html"><a href="chapitre3.html#le-lissage-spatial"><i class="fa fa-check"></i><b>3.5</b> Le lissage spatial</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre3.html"><a href="chapitre3.html#kde"><i class="fa fa-check"></i><b>3.5.1</b> KDE</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre3.html"><a href="chapitre3.html#stewart"><i class="fa fa-check"></i><b>3.5.2</b> Stewart</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre3.html"><a href="chapitre3.html#d"><i class="fa fa-check"></i><b>3.6</b> 3D</a><ul>
<li class="chapter" data-level="3.6.1" data-path="chapitre3.html"><a href="chapitre3.html#linemap"><i class="fa fa-check"></i><b>3.6.1</b> linemap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i><b>4</b> <code>sessionInfo()</code></a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rCarto/carto_avec_r" target="blank">Contribuer</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cartographie avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre2" class="section level1">
<h1><span class="header-section-number">Chapitre 2</span> Cartographie thématique</h1>
<p>Nous ne détaillerons pas ici les règles de la cartographie thématique.
Le lecteur pourra se référer à divers ouvrages de référence : <span class="citation">Bertin (<a href="#ref-Bertin67">1967</a>)</span>, <span class="citation">Pumain and Béguin (<a href="#ref-Beguin10">2010</a>)</span>, <span class="citation">Lambert and Zanin (<a href="#ref-Lambert16">2016</a>)</span></p>
<div id="le-package-cartography" class="section level2">
<h2><span class="header-section-number">2.1</span> Le package <code>cartography</code></h2>
<p>Le package <code>cartography</code> <span class="citation">(Giraud and Lambert <a href="#ref-R-cartography">2018</a><a href="#ref-R-cartography">a</a>)</span> permet de créer et intégrer des cartes thématiques dans sa chaîne de traitements en R. Il permet des représentations cartographiques tels que les cartes en symboles proportionnels, des cartes choroplèthes, des typologies, des cartes de flux ou des cartes de discontinuités. Il offre également des fonctions qui permettent d’améliorer la réalisation de la carte, comme des palettes de couleur, des éléments d’habillage (échelle, flèche du nord, titre, légende…), d’y rattacher des labels ou d’accéder à des APIs cartographiques.</p>
<p>Pour utiliser aisément ce package, plusieurs sources d’intérêts peuvent être consultées :</p>
<ul>
<li>La documentation du package accessible directement dans R :</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">?cartography</code></pre>
<ul>
<li>La <a href="https://CRAN.R-project.org/package=cartography/vignettes/cartography.html" target="_blank">vignette</a> associée au package présente des exemples de scripts</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vignette</span>(<span class="st">&quot;cartography&quot;</span>)</code></pre>
<ul>
<li><p>Le blog <a href="https://rgeomatic.hypotheses.org/" target="_blank">R Géomatique</a> met à disposition ressources et exemples liés au package et plus généralement à l’écosystème spatiale de R.</p></li>
<li><p>La <a href="http://riatelab.github.io/cartography/vignettes/cheatsheet/cartography_cheatsheet.pdf" target="_blank">cheat sheet</a> de cartography, qui résume les principales fonctions du package de façon synthétique.</p></li>
</ul>
<p><img src="img/cheat_sheet.png" width="1000" style="display: block; margin: auto;" /></p>
</div>
<div id="representations-usuelles" class="section level2">
<h2><span class="header-section-number">2.2</span> Représentations usuelles</h2>
<div id="carte-de-symboles-proportionnels" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Carte de symboles proportionnels</h3>
<p>Plusieurs symboles sont disponibles : cercles, carrés et bars.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cartography)
<span class="kw">library</span>(sf)
<span class="co"># Import des données</span>
mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/martinique.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)
<span class="co"># Communes</span>
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="st">&quot;lightblue4&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;lightblue3&quot;</span>, 
     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="co"># Symboles proportionnels</span>
<span class="kw">propSymbolsLayer</span>(<span class="dt">x =</span> mtq, <span class="dt">var =</span> <span class="st">&quot;P13_POP&quot;</span>, 
                 <span class="dt">legend.title.txt =</span> <span class="st">&quot;Total</span><span class="ch">\n</span><span class="st">population (2013)&quot;</span>)
<span class="co"># Titre</span>
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Population en Martinique&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/propS-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="carte-choroplethe" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Carte choroplèthe</h3>
<pre class="sourceCode r"><code class="sourceCode r">mtq<span class="op">$</span>cagr &lt;-<span class="st"> </span>(((mtq<span class="op">$</span>P13_POP <span class="op">/</span><span class="st"> </span>mtq<span class="op">$</span>P08_POP)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>
<span class="kw">choroLayer</span>(<span class="dt">x =</span> mtq, <span class="dt">var =</span> <span class="st">&quot;cagr&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">6.14</span>,<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),
           <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#135D89&quot;</span>, <span class="st">&quot;#4D95BA&quot;</span>, <span class="st">&quot;#96D1EA&quot;</span>, <span class="st">&quot;#FCDACA&quot;</span>, <span class="st">&quot;#EC4E49&quot;</span>),
           <span class="dt">legend.title.txt =</span> <span class="st">&quot;Compound annual</span><span class="ch">\n</span><span class="st">growth rate&quot;</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Evolution de la population&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/choro-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="elements-dhabillage" class="section level2">
<h2><span class="header-section-number">2.3</span> Éléments d’habillage</h2>
<p>Titre, sources, auteur</p>
<div id="ajuster-les-marges-de-la-figures" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Ajuster les marges de la figures</h3>
</div>
<div id="fleche-nord" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Flèche nord</h3>
</div>
<div id="echelle" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Échelle</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="st">&quot;lightblue4&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;lightblue3&quot;</span>, 
     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Martinique&quot;</span>, <span class="dt">sources =</span> <span class="st">&quot;IGN&quot;</span>, 
            <span class="dt">author =</span> <span class="st">&quot;Giraud &amp; Pécout, 2018&quot;</span>, 
            <span class="dt">col =</span><span class="st">&quot;grey20&quot;</span>, <span class="dt">coltitle =</span> <span class="st">&quot;red&quot;</span>,
            <span class="dt">tabtitle =</span> <span class="ot">TRUE</span>, <span class="dt">frame =</span> <span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">NULL</span>)
<span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topright&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">barscale</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="fl">1.2</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/layout1-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="st">&quot;darkseagreen3&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;darkseagreen4&quot;</span>,
     <span class="dt">bg =</span> <span class="st">&quot;#A6CAE0&quot;</span>)
<span class="kw">labelLayer</span>(<span class="dt">x =</span> mtq, <span class="dt">txt =</span> <span class="st">&quot;LIBGEO&quot;</span>, <span class="dt">col=</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">font =</span> <span class="dv">4</span>,
           <span class="dt">halo =</span> <span class="ot">TRUE</span>, <span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">r =</span> <span class="fl">0.1</span>, <span class="dt">overlap =</span> <span class="ot">FALSE</span>, 
           <span class="dt">show.lines =</span> <span class="ot">FALSE</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Communes&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">north=</span><span class="ot">TRUE</span>,  
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/labs-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="creer-un-effet-crayonne" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Créer un effet crayonné</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
mtq_pencil &lt;-<span class="st"> </span><span class="kw">getPencilLayer</span>(<span class="dt">x =</span> mtq)
<span class="kw">typoLayer</span>(
  <span class="dt">x =</span> mtq_pencil, <span class="dt">var=</span><span class="st">&quot;STATUT&quot;</span>, <span class="dt">add =</span> <span class="ot">FALSE</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine4&quot;</span>, <span class="st">&quot;yellow3&quot;</span>,<span class="st">&quot;wheat&quot;</span>),
  <span class="dt">legend.values.order =</span> <span class="kw">c</span>(<span class="st">&quot;Préfecture de région&quot;</span>,
                          <span class="st">&quot;Sous-préfecture&quot;</span>, 
                          <span class="st">&quot;Commune simple&quot;</span>),
  <span class="dt">legend.pos =</span> <span class="st">&quot;topright&quot;</span>,
  <span class="dt">legend.title.txt =</span> <span class="st">&quot;Status&quot;</span>
)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">ldy=</span><span class="dv">2</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Statut Administratif&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, 
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)
<span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topleft&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/pencil-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="ajouter-un-ombrage-a-une-couche" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Ajouter un ombrage à une couche</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq) <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">-500</span>), 
     <span class="dt">col =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col=</span><span class="st">&quot;darkseagreen3&quot;</span>, <span class="dt">border=</span><span class="st">&quot;darkseagreen4&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Communes&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">north=</span><span class="ot">TRUE</span>,  
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/shadow-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="palettes-de-couleurs" class="section level2">
<h2><span class="header-section-number">2.4</span> Palettes de couleurs</h2>
<p>La fonction <code>display.carto.all()</code> permet d’afficher toutes palettes de couleurs disponibles dans <code>cartography</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">display.carto.all</span>(<span class="dv">20</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/pa-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>La fonction <code>display.carto.pal()</code> permet de détailler une palette de couleurs.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">display.carto.pal</span>(<span class="st">&quot;orange.pal&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/pal1-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>La fonction <code>carto.pal()</code> permet de construire une palette de couleur.
Il est possible de créer des palettes associant 2 couleurs.</p>
<pre class="sourceCode r"><code class="sourceCode r">mypal &lt;-<span class="st"> </span><span class="kw">carto.pal</span>(<span class="dt">pal1 =</span> <span class="st">&quot;wine.pal&quot;</span>, <span class="dt">n1 =</span> <span class="dv">5</span>, <span class="dt">pal2 =</span> <span class="st">&quot;green.pal&quot;</span>, <span class="dt">n2 =</span> <span class="dv">4</span>)
<span class="kw">image</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">1</span>, <span class="kw">as.matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>), <span class="dt">col=</span>mypal, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, 
      <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/pal2-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="discretisations" class="section level2">
<h2><span class="header-section-number">2.5</span> Discrétisations</h2>
<p>La fonction <code>getBreaks()</code> met à disposition les méthodes de discrétisations de variables classique : quantiles, moyenn/écart-type, amplitudes égales, moyennes emboitées, Fisher-Jenks, géométrique …</p>
<pre class="sourceCode r"><code class="sourceCode r">var &lt;-<span class="st"> </span>mtq<span class="op">$</span>cagr
moy &lt;-<span class="st"> </span><span class="kw">mean</span>(var)
med &lt;-<span class="st"> </span><span class="kw">median</span>(var)
std &lt;-<span class="st"> </span><span class="kw">sd</span>(var)
<span class="co"># Quantile intervals</span>
breaks &lt;-<span class="st"> </span><span class="kw">getBreaks</span>(<span class="dt">v =</span> var, <span class="dt">nclass =</span> <span class="dv">6</span>, <span class="dt">method =</span> <span class="st">&quot;quantile&quot;</span>)
<span class="kw">hist</span>(var, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">breaks =</span> breaks, <span class="dt">main=</span><span class="st">&quot;quantiles&quot;</span>,
     <span class="dt">col =</span> <span class="kw">carto.pal</span>(<span class="dt">pal1 =</span> <span class="st">&quot;wine.pal&quot;</span>,<span class="dv">3</span>, <span class="st">&quot;green.pal&quot;</span>, <span class="dv">3</span>))
<span class="kw">rug</span>(var)
<span class="kw">abline</span>(<span class="dt">v =</span> med, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/discr2-1.png" width="480" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Mean and standard deviation (msd)</span>
breaks &lt;-<span class="st"> </span><span class="kw">getBreaks</span>(<span class="dt">v =</span> var, <span class="dt">method =</span> <span class="st">&quot;msd&quot;</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">middle =</span> <span class="ot">TRUE</span>)
<span class="kw">hist</span>(var, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">breaks =</span> breaks, <span class="dt">main=</span><span class="st">&quot;moyenne / écart-type&quot;</span>,
     <span class="dt">col =</span> <span class="kw">carto.pal</span>(<span class="dt">pal1 =</span> <span class="st">&quot;wine.pal&quot;</span>,<span class="dv">3</span> , <span class="st">&quot;green.pal&quot;</span>, <span class="dv">2</span>, <span class="dt">middle =</span> <span class="ot">TRUE</span>))
<span class="kw">rug</span>(var)
<span class="kw">abline</span>(<span class="dt">v =</span> moy, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> moy <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>std, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> moy <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>std, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/discr3-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="combinaisons" class="section level2">
<h2><span class="header-section-number">2.6</span> Combinaisons</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col=</span><span class="st">&quot;darkseagreen3&quot;</span>, <span class="dt">border=</span><span class="st">&quot;darkseagreen4&quot;</span>,  
     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="kw">propSymbolsChoroLayer</span>(
  <span class="dt">x =</span> mtq, <span class="dt">var=</span> <span class="st">&quot;P13_POP&quot;</span>,
  <span class="dt">legend.var.title.txt =</span> <span class="st">&quot;Total</span><span class="ch">\n</span><span class="st">population (2013)&quot;</span>,
  <span class="dt">var2 =</span> <span class="st">&quot;cagr&quot;</span>, <span class="dt">legend.var.pos =</span> <span class="st">&quot;bottomleft&quot;</span>,
  <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">6.14</span>,<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;#135D89&quot;</span>, <span class="st">&quot;#4D95BA&quot;</span>, <span class="st">&quot;#96D1EA&quot;</span>, <span class="st">&quot;#FCDACA&quot;</span>, <span class="st">&quot;#EC4E49&quot;</span>),
  <span class="dt">legend.var2.title.txt =</span> <span class="st">&quot;Compound annual</span><span class="ch">\n</span><span class="st">growth rate&quot;</span>
)
<span class="co"># Title</span>
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Evolution de la population&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, 
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)
<span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topleft&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/choroprop-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="les-donnees-osm" class="section level2">
<h2><span class="header-section-number">2.7</span> Les données OSM</h2>
<p><a href="https://www.openstreetmap.org" target="_blank">OpenStreetMap (OSM)</a> est un projet de cartographie participative qui a pour but de constituer une base de données géographiques libre à l’échelle mondiale. OpenStreetMap vous permet de voir, modifier et utiliser des données géographiques dans le Monde entier. En résumé, c’est comme Google Maps, mais en mieux…</p>
<div id="donnees-vectorielles" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Données vectorielles</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;osmdata&quot;</span>)
<span class="co"># Définition d&#39;une bounding box</span>
q &lt;-<span class="st"> </span><span class="kw">opq</span>(<span class="dt">bbox=</span><span class="kw">st_bbox</span>(<span class="kw">st_transform</span>(mtq,<span class="dv">4326</span>)))
<span class="co"># Extraction des resaturants</span>
res &lt;-<span class="st"> </span><span class="kw">add_osm_feature</span>(<span class="dt">opq =</span> q, <span class="dt">key =</span> <span class="st">&#39;amenity&#39;</span>, <span class="dt">value =</span> <span class="st">&quot;restaurant&quot;</span>)
res.sf &lt;-<span class="st"> </span><span class="kw">osmdata_sf</span>(res)
res.sf.pts  &lt;-<span class="st"> </span>res.sf<span class="op">$</span>osm_points[<span class="op">!</span><span class="kw">is.na</span>(res.sf<span class="op">$</span>osm_points<span class="op">$</span>amenity),]
res.sf.pol &lt;-<span class="st"> </span>res.sf<span class="op">$</span>osm_polygons
<span class="kw">st_geometry</span>(res.sf.pol) &lt;-<span class="st"> </span><span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(res.sf.pol))
<span class="co"># Extraction des fast food</span>
ff &lt;-<span class="st"> </span><span class="kw">add_osm_feature</span>(<span class="dt">opq =</span> q, <span class="dt">key =</span> <span class="st">&#39;amenity&#39;</span>,<span class="dt">value =</span> <span class="st">&quot;fast_food&quot;</span>)
ff.sf &lt;-<span class="st"> </span><span class="kw">osmdata_sf</span>(ff)
ff.sf.pts  &lt;-<span class="st"> </span>ff.sf<span class="op">$</span>osm_points[<span class="op">!</span><span class="kw">is.na</span>(ff.sf<span class="op">$</span>osm_points<span class="op">$</span>amenity),]
ff.sf.pol &lt;-<span class="st"> </span>ff.sf<span class="op">$</span>osm_polygons
<span class="kw">st_geometry</span>(ff.sf.pol) &lt;-<span class="st"> </span><span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(ff.sf.pol))
<span class="co"># Extraction des cafés</span>
caf &lt;-<span class="st"> </span><span class="kw">add_osm_feature</span>(<span class="dt">opq =</span> q, <span class="dt">key =</span> <span class="st">&#39;amenity&#39;</span>, <span class="dt">value =</span> <span class="st">&quot;cafe&quot;</span> )
caf.sf &lt;-<span class="st"> </span><span class="kw">osmdata_sf</span>(caf)
caf.sf.pts  &lt;-<span class="st"> </span>caf.sf<span class="op">$</span>osm_points[<span class="op">!</span><span class="kw">is.na</span>(caf.sf<span class="op">$</span>osm_points<span class="op">$</span>amenity),]
caf.sf.pol &lt;-<span class="st"> </span>caf.sf<span class="op">$</span>osm_polygons
<span class="kw">st_geometry</span>(caf.sf.pol) &lt;-<span class="st"> </span><span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(caf.sf.pol))
<span class="co"># regroupement des 3 types d&#39;établissement</span>
resto &lt;-<span class="st"> </span><span class="kw">rbind</span>(
  res.sf.pts[, <span class="kw">c</span>(<span class="st">&quot;osm_id&quot;</span>, <span class="st">&quot;name&quot;</span>)], res.sf.pol[, <span class="kw">c</span>(<span class="st">&quot;osm_id&quot;</span>, <span class="st">&quot;name&quot;</span>)], 
  ff.sf.pts[, <span class="kw">c</span>(<span class="st">&quot;osm_id&quot;</span>, <span class="st">&quot;name&quot;</span>)], ff.sf.pol[, <span class="kw">c</span>(<span class="st">&quot;osm_id&quot;</span>, <span class="st">&quot;name&quot;</span>)], 
  caf.sf.pts[, <span class="kw">c</span>(<span class="st">&quot;osm_id&quot;</span>, <span class="st">&quot;name&quot;</span>)], caf.sf.pol[, <span class="kw">c</span>(<span class="st">&quot;osm_id&quot;</span>, <span class="st">&quot;name&quot;</span>)]
)
resto &lt;-<span class="st"> </span><span class="kw">st_transform</span>(resto, <span class="kw">st_crs</span>(mtq))


<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col=</span><span class="st">&quot;darkseagreen3&quot;</span>, <span class="dt">border=</span><span class="st">&quot;darkseagreen4&quot;</span>,  
     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(resto), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#330A5FFF&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Répartition des restaurants&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016 - OSM, 2018&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">north=</span><span class="ot">TRUE</span>,
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/unnamed-chunk-17-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="donnees-raster" class="section level3">
<h3><span class="header-section-number">2.7.2</span> Données raster</h3>
<pre class="sourceCode r"><code class="sourceCode r">type &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;osm&quot;</span>, <span class="st">&quot;hotstyle&quot;</span>,  <span class="st">&quot;hikebike&quot;</span>, <span class="st">&quot;osmgrayscale&quot;</span>, <span class="st">&quot;stamenbw&quot;</span>,
           <span class="st">&quot;stamenwatercolor&quot;</span>, <span class="st">&quot;cartodark&quot;</span>, <span class="st">&quot;cartolight&quot;</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))
<span class="cf">for</span> (i <span class="cf">in</span> type){
  <span class="kw">tilesLayer</span>(<span class="kw">getTiles</span>(<span class="dt">x =</span> mtq, <span class="dt">type =</span> i, <span class="dt">crop=</span><span class="ot">TRUE</span>))
  <span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">-1.5</span>, <span class="dt">text =</span> i, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
}</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/osmdisplay-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="creation-de-cartons" class="section level2">
<h2><span class="header-section-number">2.8</span> Création de cartons</h2>
<p>Le package <code>mapinsetr</code><span class="citation">(Giraud and Lambert <a href="#ref-R-mapinsetr">2018</a><a href="#ref-R-mapinsetr">b</a>)</span> est dédié à la crétion de cartons cartographiques. Il n’est pas sur le CRAN pour l’instant, mais on peut l’installer via le package <code>remotes</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;riatelab/mapinsetr&quot;</span>)</code></pre>
<p><code>mapinsetr</code> permet de découper, redimensionner et déplacer une zone d’un fond de carte.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mapinsetr)
<span class="kw">library</span>(cartography)
<span class="kw">library</span>(sf)
mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/martinique.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)
resto &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/resto.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)
<span class="co"># Création d&#39;un masque</span>
box_FDF &lt;-<span class="st"> </span><span class="kw">create_mask</span>(<span class="dt">bb =</span> <span class="kw">c</span>(<span class="dv">706880</span>, <span class="dv">1615030</span>, <span class="dv">708650</span>, <span class="dv">1616870</span>), 
                       <span class="dt">prj =</span> <span class="kw">st_crs</span>(mtq))
<span class="co"># Découpage, déplacement et redimentionnement des couches sous le masque</span>
zbox_FDF &lt;-<span class="st"> </span><span class="kw">move_and_resize</span>(
  <span class="dt">x =</span> box_FDF, 
  <span class="dt">mask =</span> box_FDF, 
  <span class="dt">xy =</span> <span class="kw">c</span>(<span class="dv">689000</span>, <span class="dv">1603000</span>), 
  <span class="dt">k =</span> <span class="dv">7</span>
)
zmtq_FDF &lt;-<span class="st"> </span><span class="kw">move_and_resize</span>(
  <span class="dt">x =</span> mtq, 
  <span class="dt">mask =</span> box_FDF, 
  <span class="dt">xy =</span> <span class="kw">c</span>(<span class="dv">689000</span>, <span class="dv">1603000</span>), 
  <span class="dt">k =</span> <span class="dv">7</span>
)
zresto_FDF &lt;-<span class="st"> </span><span class="kw">move_and_resize</span>(
  <span class="dt">x =</span> resto, 
  <span class="dt">mask =</span> box_FDF, 
  <span class="dt">xy =</span> <span class="kw">c</span>(<span class="dv">689000</span>, <span class="dv">1603000</span>), 
  <span class="dt">k =</span> <span class="dv">7</span>
)
<span class="co"># Affichage de la carte et des couhes crées</span>
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="st">&quot;lightblue4&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;lightblue3&quot;</span>, 
     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(resto), <span class="dt">add=</span>T, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#330A5FFF&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(box_FDF), <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> T, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(zmtq_FDF), <span class="dt">col =</span> <span class="st">&quot;lightblue4&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;lightblue3&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(zresto_FDF), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#330A5FFF&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(zbox_FDF), <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> T, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Carte initiale + couches créées&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">north=</span><span class="ot">TRUE</span>,  
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/inset1-1.png" width="384" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Création de couches unqiues comprenant le zoom</span>
resto &lt;-<span class="st"> </span><span class="kw">inset_rbinder</span>(<span class="dt">l =</span> <span class="kw">list</span>(resto, zresto_FDF))
mtq &lt;-<span class="st"> </span><span class="kw">inset_rbinder</span>(<span class="dt">l =</span> <span class="kw">list</span>(mtq, zmtq_FDF))
box &lt;-<span class="st"> </span><span class="kw">inset_rbinder</span>(<span class="dt">l =</span> <span class="kw">list</span>(box_FDF, zbox_FDF))
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="st">&quot;lightblue4&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;lightblue3&quot;</span>, 
     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(resto), <span class="dt">add=</span>T, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#330A5FFF&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(box), <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> T, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Carte finale avec carton&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,
           <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">north=</span><span class="ot">TRUE</span>,  
           <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/inset1-2.png" width="384" style="display: block; margin: auto;" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Bertin67">
<p>Bertin, Jacques. 1967. “Sémiologie Graphique: Les Diagrammes, Les Réseaux, Les Cartes, Les Réimpressions Des Éditions de L’Ecole Des Hautes Études En Sciences Sociales.” Paris: Mouton &amp; Gauthier-Villars.</p>
</div>
<div id="ref-Beguin10">
<p>Pumain, Denise, and Michèle Béguin. 2010. <em>La Représentation Des Données Géographiques: Statistique et Cartographie</em>. Armand Colin.</p>
</div>
<div id="ref-Lambert16">
<p>Lambert, Nicolas, and Christine Zanin. 2016. <em>Manuel de Cartographie: Principes, Méthodes, Applications</em>. Armand Colin.</p>
</div>
<div id="ref-R-cartography">
<p>Giraud, Timothée, and Nicolas Lambert. 2018a. <em>Cartography: Thematic Cartography</em>. <a href="https://github.com/riatelab/cartography/" class="uri">https://github.com/riatelab/cartography/</a>.</p>
</div>
<div id="ref-R-mapinsetr">
<p>Giraud, Timothée, and Nicolas Lambert. 2018b. <em>Mapinsetr: Create Map Insets</em>. <a href="https://github.com/riatelab/mapinsetr/" class="uri">https://github.com/riatelab/mapinsetr/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapitre1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapitre3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Cartographie_avec_R.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

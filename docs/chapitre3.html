<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 3 Cartographie thématique avancée | Cartographie avec R</title>
  <meta name="description" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  <meta name="github-repo" content="rCarto/carto_avec_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  
  <meta name="twitter:description" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  

<meta name="author" content="Timothée Giraud &amp; Hugues Pecout" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapitre2.html"/>
<link rel="next" href="sessioninfo.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="resto-1-attachment" rel="attachment" href="libs/resto-0.0.1/resto_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<link id="mtq-1-attachment" rel="attachment" href="libs/mtq-0.0.1/mtq_layer.fgb"/>
<link id="Restaurants-1-attachment" rel="attachment" href="libs/Restaurants-0.0.1/Restaurants_layer.fgb"/>
<link id="Communes-1-attachment" rel="attachment" href="libs/Communes-0.0.1/Communes_layer.fgb"/>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cartographie avec R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapitre1.html"><a href="chapitre1.html"><i class="fa fa-check"></i><b>1</b> Les données spatiales</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapitre1.html"><a href="chapitre1.html#le-package-sf"><i class="fa fa-check"></i><b>1.1</b> Le package <code>sf</code></a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="chapitre1.html"><a href="chapitre1.html#format-des-objets-spatiaux-sf"><i class="fa fa-check"></i><b>1.1.1</b> Format des objets spatiaux <code>sf</code></a></li>
<li class="chapter" data-level="1.1.2" data-path="chapitre1.html"><a href="chapitre1.html#import-export"><i class="fa fa-check"></i><b>1.1.2</b> Import / Export</a></li>
<li class="chapter" data-level="1.1.3" data-path="chapitre1.html"><a href="chapitre1.html#affichage-de-données"><i class="fa fa-check"></i><b>1.1.3</b> Affichage de données</a></li>
<li class="chapter" data-level="1.1.4" data-path="chapitre1.html"><a href="chapitre1.html#joindre-des-données"><i class="fa fa-check"></i><b>1.1.4</b> Joindre des données</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chapitre1.html"><a href="chapitre1.html#les-systèmes-de-projections"><i class="fa fa-check"></i><b>1.2</b> Les systèmes de projections</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapitre1.html"><a href="chapitre1.html#consulter-la-projection-dun-objet"><i class="fa fa-check"></i><b>1.2.1</b> Consulter la projection d’un objet</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapitre1.html"><a href="chapitre1.html#modifier-la-projection-dun-objet"><i class="fa fa-check"></i><b>1.2.2</b> Modifier la projection d’un objet</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapitre1.html"><a href="chapitre1.html#exercice"><i class="fa fa-check"></i><b>1.2.3</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapitre1.html"><a href="chapitre1.html#opérations-de-géotraitement"><i class="fa fa-check"></i><b>1.3</b> Opérations de géotraitement</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chapitre1.html"><a href="chapitre1.html#sélection-par-attributs"><i class="fa fa-check"></i><b>1.3.1</b> Sélection par attributs</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapitre1.html"><a href="chapitre1.html#sélection-spatiale"><i class="fa fa-check"></i><b>1.3.2</b> Sélection spatiale</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapitre1.html"><a href="chapitre1.html#extraire-des-centroides"><i class="fa fa-check"></i><b>1.3.3</b> Extraire des centroides</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapitre1.html"><a href="chapitre1.html#créer-une-matrice-de-distances"><i class="fa fa-check"></i><b>1.3.4</b> Créer une matrice de distances</a></li>
<li class="chapter" data-level="1.3.5" data-path="chapitre1.html"><a href="chapitre1.html#agréger-des-polygones"><i class="fa fa-check"></i><b>1.3.5</b> Agréger des polygones</a></li>
<li class="chapter" data-level="1.3.6" data-path="chapitre1.html"><a href="chapitre1.html#agréger-des-polygones-en-fonction-dune-variable"><i class="fa fa-check"></i><b>1.3.6</b> Agréger des polygones en fonction d’une variable</a></li>
<li class="chapter" data-level="1.3.7" data-path="chapitre1.html"><a href="chapitre1.html#construire-une-zone-tampon"><i class="fa fa-check"></i><b>1.3.7</b> Construire une zone tampon</a></li>
<li class="chapter" data-level="1.3.8" data-path="chapitre1.html"><a href="chapitre1.html#exercice-1"><i class="fa fa-check"></i><b>1.3.8</b> Exercice</a></li>
<li class="chapter" data-level="1.3.9" data-path="chapitre1.html"><a href="chapitre1.html#réaliser-une-intersection"><i class="fa fa-check"></i><b>1.3.9</b> Réaliser une intersection</a></li>
<li class="chapter" data-level="1.3.10" data-path="chapitre1.html"><a href="chapitre1.html#compter-des-points-dans-un-polygone"><i class="fa fa-check"></i><b>1.3.10</b> Compter des points dans un polygone</a></li>
<li class="chapter" data-level="1.3.11" data-path="chapitre1.html"><a href="chapitre1.html#construire-des-polygones-de-voronoi"><i class="fa fa-check"></i><b>1.3.11</b> Construire des polygones de Voronoi</a></li>
<li class="chapter" data-level="1.3.12" data-path="chapitre1.html"><a href="chapitre1.html#construction-dobjets-sf"><i class="fa fa-check"></i><b>1.3.12</b> Construction d’objets sf</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapitre1.html"><a href="chapitre1.html#géocodage-dadresses"><i class="fa fa-check"></i><b>1.4</b> Géocodage d’adresses</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapitre1.html"><a href="chapitre1.html#exercice-2"><i class="fa fa-check"></i><b>1.4.1</b> Exercice</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chapitre1.html"><a href="chapitre1.html#importer-des-données-osm"><i class="fa fa-check"></i><b>1.5</b> Importer des données OSM</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="chapitre1.html"><a href="chapitre1.html#exercice-3"><i class="fa fa-check"></i><b>1.5.1</b> Exercice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre2.html"><a href="chapitre2.html"><i class="fa fa-check"></i><b>2</b> Cartographie thématique</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapitre2.html"><a href="chapitre2.html#le-package-cartography"><i class="fa fa-check"></i><b>2.1</b> Le package <code>cartography</code></a></li>
<li class="chapter" data-level="2.2" data-path="chapitre2.html"><a href="chapitre2.html#représentations-usuelles"><i class="fa fa-check"></i><b>2.2</b> Représentations usuelles</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-symboles-proportionnels"><i class="fa fa-check"></i><b>2.2.1</b> Carte de symboles proportionnels</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapitre2.html"><a href="chapitre2.html#carte-choroplèthe"><i class="fa fa-check"></i><b>2.2.2</b> Carte choroplèthe</a></li>
<li class="chapter" data-level="2.2.3" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-typologie"><i class="fa fa-check"></i><b>2.2.3</b> Carte de typologie</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapitre2.html"><a href="chapitre2.html#combinaisons-de-représentations"><i class="fa fa-check"></i><b>2.3</b> Combinaisons de représentations</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-stocks-et-de-ratios"><i class="fa fa-check"></i><b>2.3.1</b> Carte de stocks et de ratios</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-stocks-et-de-qualitative"><i class="fa fa-check"></i><b>2.3.2</b> Carte de stocks et de qualitative</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre2.html"><a href="chapitre2.html#mise-en-page"><i class="fa fa-check"></i><b>2.4</b> Mise en page</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chapitre2.html"><a href="chapitre2.html#habillage-complet"><i class="fa fa-check"></i><b>2.4.1</b> Habillage complet</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapitre2.html"><a href="chapitre2.html#flèche-dorientation"><i class="fa fa-check"></i><b>2.4.2</b> Flèche d’orientation</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapitre2.html"><a href="chapitre2.html#échelle"><i class="fa fa-check"></i><b>2.4.3</b> Échelle</a></li>
<li class="chapter" data-level="2.4.4" data-path="chapitre2.html"><a href="chapitre2.html#étiquettes"><i class="fa fa-check"></i><b>2.4.4</b> Étiquettes</a></li>
<li class="chapter" data-level="2.4.5" data-path="chapitre2.html"><a href="chapitre2.html#ajuster-les-marges-dune-figure"><i class="fa fa-check"></i><b>2.4.5</b> Ajuster les marges d’une figure</a></li>
<li class="chapter" data-level="2.4.6" data-path="chapitre2.html"><a href="chapitre2.html#centrer-la-carte-sur-une-région"><i class="fa fa-check"></i><b>2.4.6</b> Centrer la carte sur une région</a></li>
<li class="chapter" data-level="2.4.7" data-path="chapitre2.html"><a href="chapitre2.html#afficher-plusieurs-cartes-sur-la-même-figure"><i class="fa fa-check"></i><b>2.4.7</b> Afficher plusieurs cartes sur la même figure</a></li>
<li class="chapter" data-level="2.4.8" data-path="chapitre2.html"><a href="chapitre2.html#obtenir-un-ratio-de-figure-adapté"><i class="fa fa-check"></i><b>2.4.8</b> Obtenir un ratio de figure adapté</a></li>
<li class="chapter" data-level="2.4.9" data-path="chapitre2.html"><a href="chapitre2.html#ajouter-une-image-sur-une-carte"><i class="fa fa-check"></i><b>2.4.9</b> Ajouter une image sur une carte</a></li>
<li class="chapter" data-level="2.4.10" data-path="chapitre2.html"><a href="chapitre2.html#placer-précisément-un-élément-sur-la-carte"><i class="fa fa-check"></i><b>2.4.10</b> Placer précisément un élément sur la carte</a></li>
<li class="chapter" data-level="2.4.11" data-path="chapitre2.html"><a href="chapitre2.html#utiliser-un-fond-de-carte-osm"><i class="fa fa-check"></i><b>2.4.11</b> Utiliser un fond de carte OSM</a></li>
<li class="chapter" data-level="2.4.12" data-path="chapitre2.html"><a href="chapitre2.html#créer-un-effet-crayonné"><i class="fa fa-check"></i><b>2.4.12</b> Créer un effet crayonné</a></li>
<li class="chapter" data-level="2.4.13" data-path="chapitre2.html"><a href="chapitre2.html#ajouter-un-ombrage-à-une-couche"><i class="fa fa-check"></i><b>2.4.13</b> Ajouter un ombrage à une couche</a></li>
<li class="chapter" data-level="2.4.14" data-path="chapitre2.html"><a href="chapitre2.html#création-de-cartons"><i class="fa fa-check"></i><b>2.4.14</b> Création de cartons</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chapitre2.html"><a href="chapitre2.html#exercices"><i class="fa fa-check"></i><b>2.5</b> Exercices</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre3.html"><a href="chapitre3.html"><i class="fa fa-check"></i><b>3</b> Cartographie thématique avancée</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapitre3.html"><a href="chapitre3.html#les-cartes-de-discontinuités"><i class="fa fa-check"></i><b>3.1</b> Les cartes de discontinuités</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre3.html"><a href="chapitre3.html#les-grilles-régulières"><i class="fa fa-check"></i><b>3.2</b> Les grilles régulières</a></li>
<li class="chapter" data-level="3.3" data-path="chapitre3.html"><a href="chapitre3.html#le-lissage-spatial"><i class="fa fa-check"></i><b>3.3</b> Le lissage spatial</a></li>
<li class="chapter" data-level="3.4" data-path="chapitre3.html"><a href="chapitre3.html#cartes-en-3d"><i class="fa fa-check"></i><b>3.4</b> Cartes en 3D</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapitre3.html"><a href="chapitre3.html#linemap"><i class="fa fa-check"></i><b>3.4.1</b> linemap</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapitre3.html"><a href="chapitre3.html#relief-tanaka"><i class="fa fa-check"></i><b>3.4.2</b> Relief Tanaka</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapitre3.html"><a href="chapitre3.html#rayshader"><i class="fa fa-check"></i><b>3.4.3</b> Rayshader</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes"><i class="fa fa-check"></i><b>3.5</b> Les cartogrammes</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-de-dorling"><i class="fa fa-check"></i><b>3.5.1</b> Les cartogrammes de Dorling</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-non-continus"><i class="fa fa-check"></i><b>3.5.2</b> Les cartogrammes non continus</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-continus"><i class="fa fa-check"></i><b>3.5.3</b> Les cartogrammes continus</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapitre3.html"><a href="chapitre3.html#forces-et-faiblesses-des-cartogrammes"><i class="fa fa-check"></i><b>3.5.4</b> Forces et faiblesses des cartogrammes</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre3.html"><a href="chapitre3.html#cartographie-interactive"><i class="fa fa-check"></i><b>3.6</b> Cartographie interactive</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i><b>4</b> <code>sessionInfo()</code></a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rCarto/carto_avec_r" target="blank">Contribuer</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cartographie avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre3" class="section level1" number="3">
<h1><span class="header-section-number">Chapitre 3</span> Cartographie thématique avancée</h1>
<div id="les-cartes-de-discontinuités" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Les cartes de discontinuités</h2>
<p>Ce type de représentation permet de souligner cartographiquement les discontinuités territoriales d’un phénomène. L’accent est porté sur ce qui distingue des territoires. Pour chaque frontière nous calculons le rapports ou la différence des valeurs des polygones de part et d’autre. Puis nous représentons la frontière par un figuré d’autant plus épais que la différence est forte. Il est souvent bénéfique de coupler ce type de représentation à une représentation choroplèthe (pour comprendre le sens des discontinuités).</p>
<p><img src="img/discmet.png" width="500" style="display: block; margin: auto;" /></p>
<p><img src="img/disc2.png" width="420" style="display: block; margin: auto;" /></p>

<div class="rmdmoins">
Ces cartes ne sont pas évidentes à paramétrer. Le choix des critères (seuil, type de différences…) influence fortement la représentation. En fonction du maillage utilisé la lisibilité de la carte peut être faible.
</div>

<div class="rmdplus">
Ces représentations sont très puissantes pour montrer les inégalités.
</div>
<p>La fonctions <code>getBorder()</code> du package <code>cartography</code> permet de construire une couche des frontières terrestres. La fonction <code>discLayer()</code> permet d’afficher les discontinuités.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="chapitre3.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb101-2"><a href="chapitre3.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb101-3"><a href="chapitre3.html#cb101-3" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb101-4"><a href="chapitre3.html#cb101-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-5"><a href="chapitre3.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get borders</span></span>
<span id="cb101-6"><a href="chapitre3.html#cb101-6" aria-hidden="true" tabindex="-1"></a>mtq_bord <span class="ot">&lt;-</span> <span class="fu">getBorders</span>(<span class="at">x =</span> mtq)</span>
<span id="cb101-7"><a href="chapitre3.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot polygons</span></span>
<span id="cb101-8"><a href="chapitre3.html#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq), <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">&quot;grey60&quot;</span>)</span>
<span id="cb101-9"><a href="chapitre3.html#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot borders</span></span>
<span id="cb101-10"><a href="chapitre3.html#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb101-11"><a href="chapitre3.html#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_geometry</span>(mtq_bord), </span>
<span id="cb101-12"><a href="chapitre3.html#cb101-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">rainbow</span>(<span class="fu">nrow</span>(mtq_bord))), </span>
<span id="cb101-13"><a href="chapitre3.html#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb101-14"><a href="chapitre3.html#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb101-15"><a href="chapitre3.html#cb101-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-16"><a href="chapitre3.html#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="st">&quot;Frontières inter-communales&quot;</span>,<span class="at">tabtitle=</span><span class="cn">TRUE</span>, <span class="at">north =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-17"><a href="chapitre3.html#cb101-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="at">sources=</span><span class="st">&quot;&quot;</span>, <span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/disc-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="chapitre3.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the population density (inhab./km2) using sf::st_area()</span></span>
<span id="cb102-2"><a href="chapitre3.html#cb102-2" aria-hidden="true" tabindex="-1"></a>mtq<span class="sc">$</span>POPDENS <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fl">1e6</span> <span class="sc">*</span> mtq<span class="sc">$</span>POP <span class="sc">/</span> <span class="fu">st_area</span>(mtq))</span>
<span id="cb102-3"><a href="chapitre3.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot municipalities (only the backgroung color is plotted)</span></span>
<span id="cb102-4"><a href="chapitre3.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq), <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">bg =</span> <span class="st">&quot;lightblue1&quot;</span>, </span>
<span id="cb102-5"><a href="chapitre3.html#cb102-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">690574</span>, <span class="dv">745940</span>))</span>
<span id="cb102-6"><a href="chapitre3.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the population density with custom breaks</span></span>
<span id="cb102-7"><a href="chapitre3.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">choroLayer</span>(<span class="at">x =</span> mtq, <span class="at">var =</span> <span class="st">&quot;MED&quot;</span>,</span>
<span id="cb102-8"><a href="chapitre3.html#cb102-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">min</span>(mtq<span class="sc">$</span>MED), <span class="fu">seq</span>(<span class="dv">13000</span>, <span class="dv">21000</span>, <span class="dv">2000</span>), <span class="fu">max</span>(mtq<span class="sc">$</span>MED)),</span>
<span id="cb102-9"><a href="chapitre3.html#cb102-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="fu">carto.pal</span>(<span class="st">&quot;green.pal&quot;</span>, <span class="dv">6</span>),<span class="at">border =</span> <span class="st">&quot;white&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>, </span>
<span id="cb102-10"><a href="chapitre3.html#cb102-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.pos =</span> <span class="st">&quot;topright&quot;</span>, <span class="at">legend.title.txt =</span> <span class="st">&quot;Median Income</span><span class="sc">\n</span><span class="st">(euros)&quot;</span>,</span>
<span id="cb102-11"><a href="chapitre3.html#cb102-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb102-12"><a href="chapitre3.html#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot discontinuities</span></span>
<span id="cb102-13"><a href="chapitre3.html#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="fu">discLayer</span>(</span>
<span id="cb102-14"><a href="chapitre3.html#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mtq_bord, </span>
<span id="cb102-15"><a href="chapitre3.html#cb102-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> mtq, </span>
<span id="cb102-16"><a href="chapitre3.html#cb102-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="st">&quot;MED&quot;</span>,</span>
<span id="cb102-17"><a href="chapitre3.html#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;rel&quot;</span>, </span>
<span id="cb102-18"><a href="chapitre3.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;geom&quot;</span>, </span>
<span id="cb102-19"><a href="chapitre3.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">nclass =</span> <span class="dv">3</span>,</span>
<span id="cb102-20"><a href="chapitre3.html#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">threshold =</span> <span class="fl">0.4</span>,</span>
<span id="cb102-21"><a href="chapitre3.html#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizemin =</span> <span class="fl">0.7</span>, </span>
<span id="cb102-22"><a href="chapitre3.html#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizemax =</span> <span class="dv">6</span>, </span>
<span id="cb102-23"><a href="chapitre3.html#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red4&quot;</span>,</span>
<span id="cb102-24"><a href="chapitre3.html#cb102-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.values.rnd =</span> <span class="dv">1</span>, </span>
<span id="cb102-25"><a href="chapitre3.html#cb102-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title.txt =</span> <span class="st">&quot;Relative</span><span class="sc">\n</span><span class="st">Discontinuities&quot;</span>, </span>
<span id="cb102-26"><a href="chapitre3.html#cb102-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.pos =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb102-27"><a href="chapitre3.html#cb102-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb102-28"><a href="chapitre3.html#cb102-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-29"><a href="chapitre3.html#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout</span></span>
<span id="cb102-30"><a href="chapitre3.html#cb102-30" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="at">title =</span> <span class="st">&quot;Wealth Disparities in Martinique, 2015&quot;</span>, </span>
<span id="cb102-31"><a href="chapitre3.html#cb102-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">author =</span>  <span class="fu">paste0</span>(<span class="st">&quot;cartography &quot;</span>, <span class="fu">packageVersion</span>(<span class="st">&quot;cartography&quot;</span>)),</span>
<span id="cb102-32"><a href="chapitre3.html#cb102-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">sources =</span> <span class="st">&quot;Sources: Insee and IGN, 2018&quot;</span>,</span>
<span id="cb102-33"><a href="chapitre3.html#cb102-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="dv">5</span>, <span class="at">tabtitle =</span> <span class="cn">TRUE</span>,<span class="at">theme =</span> <span class="st">&quot;grey.pal&quot;</span>)</span>
<span id="cb102-34"><a href="chapitre3.html#cb102-34" aria-hidden="true" tabindex="-1"></a><span class="co"># north arrow</span></span>
<span id="cb102-35"><a href="chapitre3.html#cb102-35" aria-hidden="true" tabindex="-1"></a><span class="fu">north</span>(<span class="at">pos =</span> <span class="st">&quot;topleft&quot;</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/disc2-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="les-grilles-régulières" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Les grilles régulières</h2>
<p>La méthode du carroyage consiste à découper l’espace géographique en un maillage formé de carrés réguliers dans une projection donnée. La donnée est répartie sur ce quadrillage régulier au prorata de la surface représentée. Le quadrillage permet ainsi de s’affranchir des mailles administratives.</p>
<p><img src="img/caromet.png" width="500" style="display: block; margin: auto;" /></p>
<p><img src="img/grid.png" width="300" style="display: block; margin: auto;" />
<img src="img/grid.png" width="300" style="display: block; margin: auto;" /></p>

<div class="rmdmoins">
Ces représentation induisent une perte de précision. Les maillages produit n’ont pas de signification. La version simple (les valeurs sont redistribuées au prorata de la surface), implique une equirépartition du phénomène dans chaque unités.
</div>

<div class="rmdplus">
La comparaison de maillages différents, à plusieurs dates ou de différentes sources est rendue possible.
</div>
<p>La fonction <code>getGridLayer()</code> du package <code>cartography</code> permet de construire ces grilles régulières.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="chapitre3.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb103-2"><a href="chapitre3.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb103-3"><a href="chapitre3.html#cb103-3" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb103-4"><a href="chapitre3.html#cb103-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-5"><a href="chapitre3.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot dentsity of population </span></span>
<span id="cb103-6"><a href="chapitre3.html#cb103-6" aria-hidden="true" tabindex="-1"></a>mtq<span class="sc">$</span>dens <span class="ot">&lt;-</span> mtq<span class="sc">$</span>POP <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(mtq) <span class="sc">/</span> (<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">1000</span>)) </span>
<span id="cb103-7"><a href="chapitre3.html#cb103-7" aria-hidden="true" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">getBreaks</span>(<span class="at">v =</span> mtq<span class="sc">$</span>dens, <span class="at">method =</span> <span class="st">&quot;q6&quot;</span>)</span>
<span id="cb103-8"><a href="chapitre3.html#cb103-8" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">carto.pal</span>(<span class="at">pal1 =</span> <span class="st">&quot;taupe.pal&quot;</span>, <span class="at">n1 =</span> <span class="dv">6</span>)</span>
<span id="cb103-9"><a href="chapitre3.html#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="fu">choroLayer</span>(</span>
<span id="cb103-10"><a href="chapitre3.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mtq, </span>
<span id="cb103-11"><a href="chapitre3.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="st">&quot;dens&quot;</span>, </span>
<span id="cb103-12"><a href="chapitre3.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> bks, </span>
<span id="cb103-13"><a href="chapitre3.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">&quot;burlywood3&quot;</span>, </span>
<span id="cb103-14"><a href="chapitre3.html#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> cols, </span>
<span id="cb103-15"><a href="chapitre3.html#cb103-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.pos =</span> <span class="st">&quot;topright&quot;</span>, </span>
<span id="cb103-16"><a href="chapitre3.html#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.values.rnd =</span> <span class="dv">1</span>,</span>
<span id="cb103-17"><a href="chapitre3.html#cb103-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title.txt =</span> <span class="st">&quot;Densité de population</span><span class="sc">\n</span><span class="st">(hab/km2)&quot;</span></span>
<span id="cb103-18"><a href="chapitre3.html#cb103-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-19"><a href="chapitre3.html#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="st">&quot;Population en Martinique&quot;</span>,<span class="at">tabtitle=</span><span class="cn">TRUE</span>, </span>
<span id="cb103-20"><a href="chapitre3.html#cb103-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="at">sources=</span><span class="st">&quot;&quot;</span>, <span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="dv">5</span>)</span>
<span id="cb103-21"><a href="chapitre3.html#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="fu">north</span>(<span class="at">pos =</span> <span class="st">&quot;topleft&quot;</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/grid-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="chapitre3.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la grille</span></span>
<span id="cb104-2"><a href="chapitre3.html#cb104-2" aria-hidden="true" tabindex="-1"></a>mygrid <span class="ot">&lt;-</span> <span class="fu">getGridLayer</span>(</span>
<span id="cb104-3"><a href="chapitre3.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mtq, </span>
<span id="cb104-4"><a href="chapitre3.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cellsize =</span> <span class="dv">10000</span> <span class="sc">*</span> <span class="dv">10000</span>, </span>
<span id="cb104-5"><a href="chapitre3.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;hexagonal&quot;</span>, </span>
<span id="cb104-6"><a href="chapitre3.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="st">&quot;POP&quot;</span></span>
<span id="cb104-7"><a href="chapitre3.html#cb104-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-8"><a href="chapitre3.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="do">## conversion from square meter to square kilometers</span></span>
<span id="cb104-9"><a href="chapitre3.html#cb104-9" aria-hidden="true" tabindex="-1"></a>mygrid<span class="sc">$</span>densitykm <span class="ot">&lt;-</span> mygrid<span class="sc">$</span>POP <span class="sc">/</span> (mygrid<span class="sc">$</span>gridarea <span class="sc">/</span> (<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">1000</span>)) </span>
<span id="cb104-10"><a href="chapitre3.html#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">choroLayer</span>(</span>
<span id="cb104-11"><a href="chapitre3.html#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mygrid, </span>
<span id="cb104-12"><a href="chapitre3.html#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="st">&quot;densitykm&quot;</span>, </span>
<span id="cb104-13"><a href="chapitre3.html#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> bks,</span>
<span id="cb104-14"><a href="chapitre3.html#cb104-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">&quot;burlywood3&quot;</span>, </span>
<span id="cb104-15"><a href="chapitre3.html#cb104-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> cols, </span>
<span id="cb104-16"><a href="chapitre3.html#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.pos =</span> <span class="st">&quot;topright&quot;</span>, </span>
<span id="cb104-17"><a href="chapitre3.html#cb104-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.values.rnd =</span> <span class="dv">1</span>,</span>
<span id="cb104-18"><a href="chapitre3.html#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title.txt =</span> <span class="st">&quot;Densité de population</span><span class="sc">\n</span><span class="st">(hab/km2)&quot;</span></span>
<span id="cb104-19"><a href="chapitre3.html#cb104-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-20"><a href="chapitre3.html#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq), <span class="at">lwd =</span> <span class="fl">0.2</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">border =</span> <span class="st">&quot;#ffffff75&quot;</span>)</span>
<span id="cb104-21"><a href="chapitre3.html#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(</span>
<span id="cb104-22"><a href="chapitre3.html#cb104-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Population en Martinique&quot;</span>,</span>
<span id="cb104-23"><a href="chapitre3.html#cb104-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">tabtitle=</span><span class="cn">TRUE</span>, </span>
<span id="cb104-24"><a href="chapitre3.html#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, </span>
<span id="cb104-25"><a href="chapitre3.html#cb104-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sources=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb104-26"><a href="chapitre3.html#cb104-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">frame=</span><span class="cn">FALSE</span>, </span>
<span id="cb104-27"><a href="chapitre3.html#cb104-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="dv">5</span></span>
<span id="cb104-28"><a href="chapitre3.html#cb104-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-29"><a href="chapitre3.html#cb104-29" aria-hidden="true" tabindex="-1"></a><span class="fu">north</span>(<span class="at">pos =</span> <span class="st">&quot;topleft&quot;</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/grid-2.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="le-lissage-spatial" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Le lissage spatial</h2>
<p>L’idée principale du lissage est de filtrer l’information pour révéler des structures spatiales sous-jacentes. C’est un ensemble de méthodes qui consistent à affecter aux points que l’on observe une valeur prenant en compte les valeurs de leur voisinage.
Il existe plusieurs méthodes de lissage (kde, potentiels…) plus ou moins paramétrables.
Cette méthode permet de passer d’une représentations de données ponctuelles vers la représentation d’une surface continue.</p>
<p><img src="img/liss1.png" width="400" style="display: block; margin: auto;" /></p>
<p><img src="img/liss2.png" width="500" style="display: block; margin: auto;" /></p>

<div class="rmdmoins">
Il est difficile de paramétrer correctement les fonctions de lissages.<br />
Elles doivent s’appuyer sur des hypothèses de comportement dans l’espace.<br />
La compréhension par un public large n’est pas évidente, il faut alors simplifier les légendes, la présentation de la méthode.
</div>

<div class="rmdplus">
Permet de faire ressortir des phénomènes spatiaux sous-jacents invisibles directement.<br />
Les cartes produites attirent l’oeil par leur originalité.<br />
Cette méthode permet de passer d’une représentation ponctuelle ou discontinue (dans un maillage) à une représentation continue s’affranchissant des maillages existants.
</div>
<p>La méthode utilisée ici est celle de l’estimation par noyau (KDE).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="chapitre3.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb105-2"><a href="chapitre3.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb105-3"><a href="chapitre3.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb105-4"><a href="chapitre3.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb105-5"><a href="chapitre3.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Import des données</span></span>
<span id="cb105-6"><a href="chapitre3.html#cb105-6" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb105-7"><a href="chapitre3.html#cb105-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-8"><a href="chapitre3.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co"># resto &lt;- st_read(dsn = &quot;data/resto.gpkg&quot;, quiet = TRUE)</span></span>
<span id="cb105-9"><a href="chapitre3.html#cb105-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">4000</span></span>
<span id="cb105-10"><a href="chapitre3.html#cb105-10" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="dv">250</span></span>
<span id="cb105-11"><a href="chapitre3.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define an observation window</span></span>
<span id="cb105-12"><a href="chapitre3.html#cb105-12" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(<span class="fu">as</span>(<span class="fu">st_union</span>(<span class="fu">st_buffer</span>(mtq, <span class="dv">100</span>)), <span class="st">&quot;Spatial&quot;</span>))</span>
<span id="cb105-13"><a href="chapitre3.html#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co"># sf to coords</span></span>
<span id="cb105-14"><a href="chapitre3.html#cb105-14" aria-hidden="true" tabindex="-1"></a>pts <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(mtq)))</span>
<span id="cb105-15"><a href="chapitre3.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Coords to ppp</span></span>
<span id="cb105-16"><a href="chapitre3.html#cb105-16" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppp</span>(pts[,<span class="dv">1</span>], pts[,<span class="dv">2</span>], <span class="at">window =</span> w, <span class="at">marks =</span> mtq<span class="sc">$</span>POP)</span>
<span id="cb105-17"><a href="chapitre3.html#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute KDE</span></span>
<span id="cb105-18"><a href="chapitre3.html#cb105-18" aria-hidden="true" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="fu">density.ppp</span>(p, <span class="at">weights =</span> p<span class="sc">$</span>marks, <span class="at">sigma =</span> sigma, <span class="at">eps =</span> res)</span>
<span id="cb105-19"><a href="chapitre3.html#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Image to raster (+ proj &amp; km2)</span></span>
<span id="cb105-20"><a href="chapitre3.html#cb105-20" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">raster</span>(dens, <span class="at">crs =</span> <span class="fu">st_crs</span>(mtq)[[<span class="dv">2</span>]]) <span class="sc">*</span> <span class="dv">1000000</span></span>
<span id="cb105-21"><a href="chapitre3.html#cb105-21" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">mask</span>(result, mtq)</span>
<span id="cb105-22"><a href="chapitre3.html#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co"># compute breaks</span></span>
<span id="cb105-23"><a href="chapitre3.html#cb105-23" aria-hidden="true" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">getBreaks</span>(<span class="fu">values</span>(result), <span class="at">nclass =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">&quot;q6&quot;</span>))</span>
<span id="cb105-24"><a href="chapitre3.html#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Color ramp</span></span>
<span id="cb105-25"><a href="chapitre3.html#cb105-25" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">hcl.colors</span>(<span class="dv">10</span>, <span class="st">&quot;viridis&quot;</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb105-26"><a href="chapitre3.html#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb105-27"><a href="chapitre3.html#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq), <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)</span>
<span id="cb105-28"><a href="chapitre3.html#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">breaks =</span> bks, <span class="at">col=</span>cols, <span class="at">add =</span> T,<span class="at">legend=</span>F)</span>
<span id="cb105-29"><a href="chapitre3.html#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_union</span>(<span class="fu">st_geometry</span>(mtq)), <span class="at">add =</span> T, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">border =</span> <span class="st">&quot;lightblue1&quot;</span>)</span>
<span id="cb105-30"><a href="chapitre3.html#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legendChoro</span>(</span>
<span id="cb105-31"><a href="chapitre3.html#cb105-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">pos =</span> <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb105-32"><a href="chapitre3.html#cb105-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">title.txt =</span> <span class="st">&quot;Densité de</span><span class="sc">\n</span><span class="st">population</span><span class="sc">\n</span><span class="st">(hab./km2)&quot;</span>,</span>
<span id="cb105-33"><a href="chapitre3.html#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> bks, </span>
<span id="cb105-34"><a href="chapitre3.html#cb105-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodata =</span> <span class="cn">FALSE</span>,</span>
<span id="cb105-35"><a href="chapitre3.html#cb105-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">values.rnd =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb105-36"><a href="chapitre3.html#cb105-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> cols</span>
<span id="cb105-37"><a href="chapitre3.html#cb105-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-38"><a href="chapitre3.html#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="at">title =</span> <span class="st">&quot;Densité de population&quot;</span>, <span class="at">tabtitle =</span> <span class="cn">TRUE</span>,</span>
<span id="cb105-39"><a href="chapitre3.html#cb105-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">author =</span> <span class="st">&quot;INSEE, 2016&quot;</span>, <span class="at">sources =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb105-40"><a href="chapitre3.html#cb105-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="dv">5</span>)</span>
<span id="cb105-41"><a href="chapitre3.html#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="fu">north</span>(<span class="at">pos =</span> <span class="st">&quot;topleft&quot;</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/kde-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="cartes-en-3d" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Cartes en 3D</h2>
<div id="linemap" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> linemap</h3>
<p>Le package <code>linemap</code> <span class="citation">(<a href="references.html#ref-R-linemap" role="doc-biblioref">Giraud 2017a</a>)</span> permet de réaliser des cartes composées de lignes.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="chapitre3.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(linemap)</span>
<span id="cb106-2"><a href="chapitre3.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb106-3"><a href="chapitre3.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;popOcc&quot;</span>)</span>
<span id="cb106-4"><a href="chapitre3.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;occitanie&quot;</span>)</span>
<span id="cb106-5"><a href="chapitre3.html#cb106-5" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">bg =</span> <span class="st">&quot;ivory2&quot;</span>)</span>
<span id="cb106-6"><a href="chapitre3.html#cb106-6" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(occitanie)</span>
<span id="cb106-7"><a href="chapitre3.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(occitanie), <span class="at">col=</span><span class="st">&quot;ivory1&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb106-8"><a href="chapitre3.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">linemap</span>(</span>
<span id="cb106-9"><a href="chapitre3.html#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> popOcc, </span>
<span id="cb106-10"><a href="chapitre3.html#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="st">&quot;pop&quot;</span>, </span>
<span id="cb106-11"><a href="chapitre3.html#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="fl">2.5</span>, </span>
<span id="cb106-12"><a href="chapitre3.html#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">threshold =</span> <span class="dv">50</span>,</span>
<span id="cb106-13"><a href="chapitre3.html#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;ivory1&quot;</span>, </span>
<span id="cb106-14"><a href="chapitre3.html#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">&quot;ivory4&quot;</span>, </span>
<span id="cb106-15"><a href="chapitre3.html#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fl">0.6</span>, </span>
<span id="cb106-16"><a href="chapitre3.html#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb106-17"><a href="chapitre3.html#cb106-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-18"><a href="chapitre3.html#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> bb[<span class="dv">1</span>], <span class="at">y =</span> bb[<span class="dv">4</span>],<span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb106-19"><a href="chapitre3.html#cb106-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="st">&quot;Répartition de la</span><span class="sc">\n</span><span class="st">population</span><span class="sc">\n</span><span class="st">en Occitanie&quot;</span>,  </span>
<span id="cb106-20"><a href="chapitre3.html#cb106-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;ivory4&quot;</span>, <span class="at">font =</span> <span class="dv">2</span>,  <span class="at">cex =</span> <span class="fl">1.8</span>)</span>
<span id="cb106-21"><a href="chapitre3.html#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add sources</span></span>
<span id="cb106-22"><a href="chapitre3.html#cb106-22" aria-hidden="true" tabindex="-1"></a>mapsources <span class="ot">&lt;-</span><span class="st">&quot;Timothée Giraud</span><span class="sc">\n</span><span class="st">linemap 0.1.0</span><span class="sc">\n</span><span class="st">Données carroyées à 1 kilomètre, INSEE 2010&quot;</span></span>
<span id="cb106-23"><a href="chapitre3.html#cb106-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> bb[<span class="dv">3</span>], <span class="at">y =</span> bb[<span class="dv">2</span>],<span class="at">labels =</span> mapsources,  </span>
<span id="cb106-24"><a href="chapitre3.html#cb106-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;ivory4&quot;</span>, <span class="at">font =</span> <span class="dv">3</span>, <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="at">cex =</span> <span class="fl">0.6</span> )</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/lines-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="relief-tanaka" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Relief Tanaka</h3>
<p>Nous utilisons le package <code>tanaka</code> <span class="citation">(<a href="references.html#ref-Tanaka20" role="doc-biblioref">Giraud 2020</a>)</span> qui met à disposition une méthode <span class="citation">(<a href="references.html#ref-Tanaka50" role="doc-biblioref">Tanaka 1950</a>)</span> utilisée pour améliorer la perception du relief.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="chapitre3.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb107-2"><a href="chapitre3.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb107-3"><a href="chapitre3.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb107-4"><a href="chapitre3.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tanaka)</span>
<span id="cb107-5"><a href="chapitre3.html#cb107-5" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb107-6"><a href="chapitre3.html#cb107-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-7"><a href="chapitre3.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># use WGS84 proj</span></span>
<span id="cb107-8"><a href="chapitre3.html#cb107-8" aria-hidden="true" tabindex="-1"></a>mtq_latlon <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(mtq, <span class="dv">4326</span>)</span>
<span id="cb107-9"><a href="chapitre3.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co"># import raster</span></span>
<span id="cb107-10"><a href="chapitre3.html#cb107-10" aria-hidden="true" tabindex="-1"></a>ras <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;data/srtm_24_10.tif&quot;</span>)</span>
<span id="cb107-11"><a href="chapitre3.html#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co"># crop on martinique area</span></span>
<span id="cb107-12"><a href="chapitre3.html#cb107-12" aria-hidden="true" tabindex="-1"></a>mtq_ras <span class="ot">&lt;-</span> <span class="fu">crop</span>(ras, <span class="fu">st_bbox</span>(mtq_latlon)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)])</span>
<span id="cb107-13"><a href="chapitre3.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate the raster</span></span>
<span id="cb107-14"><a href="chapitre3.html#cb107-14" aria-hidden="true" tabindex="-1"></a>mtq_ras <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(mtq_ras, <span class="at">fact=</span><span class="dv">4</span>, <span class="at">fun=</span>mean)</span>
<span id="cb107-15"><a href="chapitre3.html#cb107-15" aria-hidden="true" tabindex="-1"></a>mtq_ras <span class="ot">&lt;-</span> <span class="fu">projectRaster</span>(mtq_ras, <span class="at">crs=</span><span class="fu">st_crs</span>(mtq)<span class="sc">$</span>proj4string)</span>
<span id="cb107-16"><a href="chapitre3.html#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="co"># break values</span></span>
<span id="cb107-17"><a href="chapitre3.html#cb107-17" aria-hidden="true" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1300</span>,<span class="dv">100</span>),<span class="dv">1302</span>)</span>
<span id="cb107-18"><a href="chapitre3.html#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="co"># custom palette</span></span>
<span id="cb107-19"><a href="chapitre3.html#cb107-19" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#5D9D52&quot;</span>, <span class="st">&quot;#8DBC80&quot;</span>, <span class="st">&quot;#B8D9A9&quot;</span>, <span class="st">&quot;#FDEBBE&quot;</span>, <span class="st">&quot;#F7E0AC&quot;</span>, <span class="st">&quot;#F2D69B&quot;</span>, </span>
<span id="cb107-20"><a href="chapitre3.html#cb107-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;#EDCC8A&quot;</span>, <span class="st">&quot;#E8C279&quot;</span>, <span class="st">&quot;#E2B563&quot;</span>, <span class="st">&quot;#DBA84C&quot;</span>, <span class="st">&quot;#D49B36&quot;</span>, <span class="st">&quot;#BA8428&quot;</span>, </span>
<span id="cb107-21"><a href="chapitre3.html#cb107-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;#9A6A1E&quot;</span>, <span class="st">&quot;#7B5114&quot;</span>)</span>
<span id="cb107-22"><a href="chapitre3.html#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="co"># map</span></span>
<span id="cb107-23"><a href="chapitre3.html#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq), <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)</span>
<span id="cb107-24"><a href="chapitre3.html#cb107-24" aria-hidden="true" tabindex="-1"></a><span class="fu">tanaka</span>(</span>
<span id="cb107-25"><a href="chapitre3.html#cb107-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mtq_ras,</span>
<span id="cb107-26"><a href="chapitre3.html#cb107-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> bks,</span>
<span id="cb107-27"><a href="chapitre3.html#cb107-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> cols, </span>
<span id="cb107-28"><a href="chapitre3.html#cb107-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.pos =</span> <span class="st">&quot;NA&quot;</span>, </span>
<span id="cb107-29"><a href="chapitre3.html#cb107-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">mask =</span> mtq,</span>
<span id="cb107-30"><a href="chapitre3.html#cb107-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb107-31"><a href="chapitre3.html#cb107-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb107-32"><a href="chapitre3.html#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legendChoro</span>(<span class="at">pos =</span> <span class="fu">c</span>(<span class="dv">689000</span>,<span class="dv">1598000</span> ), <span class="at">breaks =</span> bks, <span class="at">col =</span> cols, <span class="at">nodata =</span> F,</span>
<span id="cb107-33"><a href="chapitre3.html#cb107-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.txt =</span> <span class="st">&quot;Elevation</span><span class="sc">\n</span><span class="st">(metres)&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb107-34"><a href="chapitre3.html#cb107-34" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="at">title =</span> <span class="st">&quot;Martinique Relief&quot;</span>, <span class="at">north =</span> T,</span>
<span id="cb107-35"><a href="chapitre3.html#cb107-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">sources =</span> <span class="st">&#39;T. Giraud, 2019&#39;</span>, <span class="at">author =</span> <span class="st">&quot;SRTM, 2018&quot;</span>, </span>
<span id="cb107-36"><a href="chapitre3.html#cb107-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb107-37"><a href="chapitre3.html#cb107-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">tabtitle =</span> T, <span class="at">coltitle =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/tanaka-1.png" width="384" style="display: block; margin: auto;" /></p>

<div class="linky">
<a href="https://rgeomatic.hypotheses.org/1758">The tanaka package</a>
</div>
</div>
<div id="rayshader" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Rayshader</h3>
<p>Le package <code>rayshader</code> <span class="citation">(<a href="references.html#ref-R-rayshader" role="doc-biblioref">Morgan-Wall 2018</a>)</span> permet de réaliser de belles cartes en relief.
L’export des images n’est pas évident, il s’agit ici d’une simple capture d’écran.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="chapitre3.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb108-2"><a href="chapitre3.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb108-3"><a href="chapitre3.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rayshader)</span>
<span id="cb108-4"><a href="chapitre3.html#cb108-4" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb108-5"><a href="chapitre3.html#cb108-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-6"><a href="chapitre3.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry</span>(mtq) <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(<span class="fu">st_geometry</span>(mtq), <span class="dv">5000</span>)</span>
<span id="cb108-7"><a href="chapitre3.html#cb108-7" aria-hidden="true" tabindex="-1"></a>mtq_latlon <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(mtq, <span class="dv">4326</span>)</span>
<span id="cb108-8"><a href="chapitre3.html#cb108-8" aria-hidden="true" tabindex="-1"></a>ras <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;data/srtm_24_10.tif&quot;</span>)</span>
<span id="cb108-9"><a href="chapitre3.html#cb108-9" aria-hidden="true" tabindex="-1"></a>mtq_ras <span class="ot">&lt;-</span> <span class="fu">crop</span>(ras, <span class="fu">st_bbox</span>(mtq_latlon)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)])</span>
<span id="cb108-10"><a href="chapitre3.html#cb108-10" aria-hidden="true" tabindex="-1"></a>mtq_ras <span class="ot">&lt;-</span> <span class="fu">projectRaster</span>(mtq_ras, <span class="at">crs=</span><span class="fu">st_crs</span>(mtq)<span class="sc">$</span>proj4string)</span>
<span id="cb108-11"><a href="chapitre3.html#cb108-11" aria-hidden="true" tabindex="-1"></a>elmat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">extract</span>(mtq_ras,<span class="fu">extent</span>(mtq_ras),<span class="at">buffer=</span><span class="dv">1000</span>),</span>
<span id="cb108-12"><a href="chapitre3.html#cb108-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">nrow=</span><span class="fu">ncol</span>(mtq_ras),<span class="at">ncol=</span><span class="fu">nrow</span>(mtq_ras))</span>
<span id="cb108-13"><a href="chapitre3.html#cb108-13" aria-hidden="true" tabindex="-1"></a>elmat[<span class="fu">is.na</span>(elmat)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb108-14"><a href="chapitre3.html#cb108-14" aria-hidden="true" tabindex="-1"></a>raymat <span class="ot">=</span> <span class="fu">ray_shade</span>(elmat,<span class="at">lambert =</span> <span class="cn">TRUE</span>,<span class="at">anglebreaks =</span> <span class="dv">85</span>,<span class="at">sunangle =</span> <span class="dv">125</span>)</span>
<span id="cb108-15"><a href="chapitre3.html#cb108-15" aria-hidden="true" tabindex="-1"></a>ambmat <span class="ot">=</span> <span class="fu">ambient_shade</span>(elmat,<span class="at">anglebreaks =</span>  <span class="dv">85</span>)</span>
<span id="cb108-16"><a href="chapitre3.html#cb108-16" aria-hidden="true" tabindex="-1"></a>elmat <span class="sc">%&gt;%</span></span>
<span id="cb108-17"><a href="chapitre3.html#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sphere_shade</span>(<span class="at">texture =</span> <span class="st">&quot;imhof1&quot;</span>,<span class="at">sunangle =</span> <span class="dv">125</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-18"><a href="chapitre3.html#cb108-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_water</span>(<span class="fu">detect_water</span>(elmat), <span class="at">color=</span><span class="st">&quot;desert&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-19"><a href="chapitre3.html#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_shadow</span>(raymat,<span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-20"><a href="chapitre3.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_shadow</span>(ambmat,<span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb108-21"><a href="chapitre3.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_3d</span>(elmat,<span class="at">zscale=</span><span class="dv">25</span>,<span class="at">fov=</span><span class="dv">10</span>,<span class="at">theta=</span><span class="sc">-</span><span class="dv">15</span>,<span class="at">phi=</span><span class="dv">70</span>, <span class="at">background=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb108-22"><a href="chapitre3.html#cb108-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">zoom=</span>.<span class="dv">5</span>, <span class="at">windowsize =</span><span class="fu">c</span>(<span class="dv">900</span>, <span class="dv">900</span>))</span></code></pre></div>
<p><img src="img/rayshade.png" width="735" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="les-cartogrammes" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Les cartogrammes</h2>
<blockquote>
<p>L’anamorphose classique est une représentation des États (ou de mailles quelconques) par <strong>des rectangles ou des polygones quelconques</strong> en fonction d’une <strong>quantité</strong> qui leur est rattaché. (…)
On s’efforce de <strong>garder l’arrangement général</strong> des mailles ou la silhouette du continent."<br />
<span class="citation"><a href="references.html#ref-Brunet93" role="doc-biblioref">Brunet, Ferras, and Théry</a> (<a href="references.html#ref-Brunet93" role="doc-biblioref">1993</a>)</span></p>
</blockquote>
<p>3 types d’anamorphoses ou cartogrammes sont ici présentés :</p>
<ul>
<li>Les cartogrammes de Dorling <span class="citation">(<a href="references.html#ref-Dorling96" role="doc-biblioref">Dorling 1996</a>)</span></li>
<li>Les cartogrammes non contigus <span class="citation">(<a href="references.html#ref-Olson76" role="doc-biblioref">Olson 1976</a>)</span></li>
<li>Les cartogrammes contigus <span class="citation">(<a href="references.html#ref-Dougenik85" role="doc-biblioref">Dougenik, Chrisman, and Niemeyer 1985</a>)</span></li>
</ul>

<div class="linky">
Un cours complet sur les anamorphoses : <a href="https://neocarto.hypotheses.org/366" target="_blank">Les anamorphoses cartographiques</a> <span class="citation">(<a href="references.html#ref-Lambert15" role="doc-biblioref">Lambert 2015</a>)</span>.
</div>

<div class="linky">
<a href="https://rgeomatic.hypotheses.org/1361">Faire des cartogrammes avec R</a>
</div>
<p>Pour réaliser les cartogrammes nous utilisons le package <code>cartogram</code> <span class="citation">(<a href="references.html#ref-R-cartogram" role="doc-biblioref">Jeworutzki 2018</a>)</span>.</p>
<div id="les-cartogrammes-de-dorling" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Les cartogrammes de Dorling</h3>
<p>Les territoires sont représentés par des figurés (cercles, des carrés ou des rectangles) ne se recouvrant pas dont les surfaces sont proportionnelles à une variable. Les positions des figurés sont définie selon les positions de départ.</p>
<p><img src="img/dorling.png" width="602" style="display: block; margin: auto;" />
<span class="citation">(<a href="references.html#ref-McCormick07" role="doc-biblioref">McCormick 2017</a>)</span></p>

<div class="rmdmoins">
On identifie assez mal l’espace.<br />
On peut nommer les cercles pour se repérer et/ou s’aider de la couleur pour faire apparaitre des clusters et mieux identifier les blocks géographiques.
</div>

<div class="rmdplus">
La perception des quantités est très bonne.<br />
Les tailles de cercles sont vraiment comparables.
</div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="chapitre3.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb109-2"><a href="chapitre3.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span>
<span id="cb109-3"><a href="chapitre3.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb109-4"><a href="chapitre3.html#cb109-4" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb109-5"><a href="chapitre3.html#cb109-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-6"><a href="chapitre3.html#cb109-6" aria-hidden="true" tabindex="-1"></a>mtq_dorling <span class="ot">&lt;-</span> <span class="fu">cartogram_dorling</span>(<span class="at">x =</span> mtq, <span class="at">weight =</span> <span class="st">&quot;POP&quot;</span>, <span class="at">k =</span> <span class="dv">12</span>) </span>
<span id="cb109-7"><a href="chapitre3.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq_dorling), <span class="at">col =</span> <span class="st">&quot;#940000&quot;</span>, <span class="at">border=</span> <span class="st">&quot;white&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb109-8"><a href="chapitre3.html#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="fu">labelLayer</span>(<span class="at">x =</span> mtq_dorling, <span class="at">txt =</span> <span class="st">&quot;LIBGEO&quot;</span>, <span class="at">overlap =</span> <span class="cn">FALSE</span>, <span class="at">show.lines =</span> <span class="cn">FALSE</span>, </span>
<span id="cb109-9"><a href="chapitre3.html#cb109-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">halo =</span> <span class="cn">TRUE</span>, <span class="at">r =</span> .<span class="dv">15</span>)</span>
<span id="cb109-10"><a href="chapitre3.html#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="st">&quot;Population en Martinique - Cartogramme de Dorling&quot;</span>,<span class="at">tabtitle=</span><span class="cn">TRUE</span>, </span>
<span id="cb109-11"><a href="chapitre3.html#cb109-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="at">sources=</span><span class="st">&quot;&quot;</span>, <span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/dorling-1.png" width="576" style="display: block; margin: auto;" />
Le paramètre <code>k</code> permet de faire varier le facteur d’expansion des cercles.</p>
</div>
<div id="les-cartogrammes-non-continus" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Les cartogrammes non continus</h3>
<p>La taille des polygones est proportionnelle à une variable. L’agencement des polygones les uns par rapport aux autres est conservée. La forme des polygones est ressemblante.</p>
<p><img src="img/nccartogram.png" width="272" style="display: block; margin: auto;" />
<span class="citation">(<a href="references.html#ref-Cauvin13" role="doc-biblioref">Cauvin, Escobar, and Serradj 2013</a>)</span></p>

<div class="rmdmoins">
La topologie des régions est perdue.
</div>

<div class="rmdplus">
La conservation de la forme des polygones est optimale.
</div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="chapitre3.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb110-2"><a href="chapitre3.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span>
<span id="cb110-3"><a href="chapitre3.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb110-4"><a href="chapitre3.html#cb110-4" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb110-5"><a href="chapitre3.html#cb110-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-6"><a href="chapitre3.html#cb110-6" aria-hidden="true" tabindex="-1"></a>mtq_ncont <span class="ot">&lt;-</span> <span class="fu">cartogram_ncont</span>(<span class="at">x =</span> mtq, <span class="at">weight =</span> <span class="st">&quot;POP&quot;</span>, <span class="at">k =</span> <span class="fl">1.5</span>) </span>
<span id="cb110-7"><a href="chapitre3.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq), <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>, <span class="at">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb110-8"><a href="chapitre3.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq_ncont), <span class="at">col =</span> <span class="st">&quot;#940000&quot;</span>, <span class="at">border=</span> <span class="st">&quot;white&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb110-9"><a href="chapitre3.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="st">&quot;Population en Martinique - Cartogramme de Olson&quot;</span>,<span class="at">tabtitle=</span><span class="cn">TRUE</span>, </span>
<span id="cb110-10"><a href="chapitre3.html#cb110-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="at">sources=</span><span class="st">&quot;&quot;</span>, <span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/olson-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Le paramètre <code>k</code> permet de faire varier le facteur d’expansion des polygones.</p>
</div>
<div id="les-cartogrammes-continus" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Les cartogrammes continus</h3>
<p>La taille des polygones est proportionnelle à une variable. L’agencement des polygones les uns par rapport aux autres est conservée. Pour conserver la contiguité, la forme des polygones est fortement transformée.</p>
<p><img src="img/cartogram.jpg" style="display: block; margin: auto;" />
<span class="citation">(<a href="references.html#ref-Paull16" role="doc-biblioref">Paull and Hennig 2016</a>)</span></p>

<div class="rmdmoins">
La forme des polygones est fortement distordue.
</div>

<div class="rmdplus">
C’est une “vraie carte de géographie” : la topologie et la contiguité sont conservées.
</div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="chapitre3.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartography)</span>
<span id="cb111-2"><a href="chapitre3.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span>
<span id="cb111-3"><a href="chapitre3.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb111-4"><a href="chapitre3.html#cb111-4" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb111-5"><a href="chapitre3.html#cb111-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb111-6"><a href="chapitre3.html#cb111-6" aria-hidden="true" tabindex="-1"></a>mtq_cont <span class="ot">&lt;-</span> <span class="fu">cartogram_cont</span>(<span class="at">x =</span> mtq, <span class="at">weight =</span> <span class="st">&quot;POP&quot;</span>, <span class="at">prepare =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb111-7"><a href="chapitre3.html#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(mtq_cont), <span class="at">col =</span> <span class="st">&quot;#940000&quot;</span>, <span class="at">border=</span> <span class="st">&quot;white&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb111-8"><a href="chapitre3.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">layoutLayer</span>(<span class="st">&quot;Population en Martinique - Cartogramme de Dougenik&quot;</span>,<span class="at">tabtitle=</span><span class="cn">TRUE</span>, </span>
<span id="cb111-9"><a href="chapitre3.html#cb111-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="at">sources=</span><span class="st">&quot;&quot;</span>, <span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/dougenik-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="forces-et-faiblesses-des-cartogrammes" class="section level3" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Forces et faiblesses des cartogrammes</h3>
<p>Les cartogrammes sont des représentations cartographiques perçues comme <strong>innovante</strong> (bien que la methode date de 40 ans). Ces images très généralisées rendent bien compte des <strong>quantités</strong> et des <strong>gradiants</strong>. Ce sont de vraies images de <strong>communication</strong> qui <strong>provoquent</strong>, suscitent <strong>l’intérêt</strong>, véhiculent un <strong>message</strong> fort, <strong>interpellent</strong>.</p>
<p>Mais les cartogrammes induisent une perte des <strong>repères visuels</strong> (difficile de retrouver son pays, ou sa région sur la carte), demandent un <strong>effort de lecture</strong> qui peut être important et ne permettent pas de <strong>gérer des données manquantes</strong>.</p>
</div>
</div>
<div id="cartographie-interactive" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Cartographie interactive</h2>
<p>Le package <code>mapview</code> <span class="citation">(<a href="references.html#ref-R-mapview" role="doc-biblioref">Appelhans et al. 2018</a>)</span> utilise le package <code>leaflet</code> <span class="citation">(<a href="references.html#ref-R-leaflet" role="doc-biblioref">Cheng, Karambelkar, and Xie 2018</a>)</span> basé sur la librairie javascript Leaflet <span class="citation">(<a href="references.html#ref-JS-Leaflet" role="doc-biblioref">Agafonkin 2015</a>)</span> pour créer des cartes interactives. La création de carte est assez aisée, la documentation est un peu dense.</p>
<p><strong>Utilisation simple</strong></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="chapitre3.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb112-2"><a href="chapitre3.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet.providers)</span>
<span id="cb112-3"><a href="chapitre3.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb112-4"><a href="chapitre3.html#cb112-4" aria-hidden="true" tabindex="-1"></a>mtq <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">&quot;gpkg/mtq.gpkg&quot;</span>, <span class="at">package=</span><span class="st">&quot;cartography&quot;</span>), </span>
<span id="cb112-5"><a href="chapitre3.html#cb112-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-6"><a href="chapitre3.html#cb112-6" aria-hidden="true" tabindex="-1"></a>resto <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/resto.gpkg&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-7"><a href="chapitre3.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(resto) <span class="sc">+</span> <span class="fu">mapview</span>(mtq) </span></code></pre></div>
<p><div id="htmlwidget-4377f8cede760f1c6a01" style="width:384px;height:460.8px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4377f8cede760f1c6a01">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addFlatGeoBuf","args":["resto","resto",null,true,"mvFeatureId",{"radius":6,"stroke":true,"color":"#333333","weight":1,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6},{"className":"","pane":"point"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-61.2264357,14.3979658,-60.826571,14.8747527,"resto","Zoom to resto","<strong> resto <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["resto"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"resto"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addFlatGeoBuf","args":["mtq","mtq",null,true,"mvFeatureId",{"radius":6,"stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6},{"className":"","pane":"polygon"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addHomeButton","args":[-61.2291071648456,14.3955692428653,-60.8110413346827,14.8781005893583,"mtq","Zoom to mtq","<strong> mtq <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],["resto","mtq"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["mtq"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"mtq"}]},{"method":"addHomeButton","args":[-61.2291071648456,14.3955692428653,-60.8110413346827,14.8781005893583,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]}],"fitBounds":[14.3955692428653,-61.2291071648456,14.8781005893583,-60.8110413346827,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</br>
<strong>Utilisation personnalisée</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="chapitre3.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(</span>
<span id="cb113-2"><a href="chapitre3.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  resto, </span>
<span id="cb113-3"><a href="chapitre3.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">map.types =</span> <span class="st">&quot;OpenStreetMap&quot;</span>, </span>
<span id="cb113-4"><a href="chapitre3.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.regions =</span> <span class="st">&quot;#940000&quot;</span>, </span>
<span id="cb113-5"><a href="chapitre3.html#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> resto<span class="sc">$</span>name,</span>
<span id="cb113-6"><a href="chapitre3.html#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha.regions=</span><span class="dv">90</span>,</span>
<span id="cb113-7"><a href="chapitre3.html#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb113-8"><a href="chapitre3.html#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb113-9"><a href="chapitre3.html#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer.name =</span> <span class="st">&quot;Restaurants&quot;</span>, </span>
<span id="cb113-10"><a href="chapitre3.html#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">homebutton =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-11"><a href="chapitre3.html#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fl">0.5</span>, </span>
<span id="cb113-12"><a href="chapitre3.html#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">popup =</span> <span class="cn">NA</span></span>
<span id="cb113-13"><a href="chapitre3.html#cb113-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb113-14"><a href="chapitre3.html#cb113-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>(</span>
<span id="cb113-15"><a href="chapitre3.html#cb113-15" aria-hidden="true" tabindex="-1"></a>    mtq, </span>
<span id="cb113-16"><a href="chapitre3.html#cb113-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.regions =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb113-17"><a href="chapitre3.html#cb113-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb113-18"><a href="chapitre3.html#cb113-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb113-19"><a href="chapitre3.html#cb113-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> mtq<span class="sc">$</span>LIBGEO, </span>
<span id="cb113-20"><a href="chapitre3.html#cb113-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha.regions=</span> <span class="fl">0.5</span>, </span>
<span id="cb113-21"><a href="chapitre3.html#cb113-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">map.types =</span> <span class="st">&quot;OpenStreetMap&quot;</span>,</span>
<span id="cb113-22"><a href="chapitre3.html#cb113-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="fl">0.5</span>, </span>
<span id="cb113-23"><a href="chapitre3.html#cb113-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">layer.name =</span> <span class="st">&quot;Communes&quot;</span>,</span>
<span id="cb113-24"><a href="chapitre3.html#cb113-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">homebutton =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-25"><a href="chapitre3.html#cb113-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> leafpop<span class="sc">::</span><span class="fu">popupTable</span>(mtq, </span>
<span id="cb113-26"><a href="chapitre3.html#cb113-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">zcol =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb113-27"><a href="chapitre3.html#cb113-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">row.numbers =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-28"><a href="chapitre3.html#cb113-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">feature.id =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-29"><a href="chapitre3.html#cb113-29" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div id="htmlwidget-08609af1572759c35b43" style="width:384px;height:460.8px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-08609af1572759c35b43">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addFlatGeoBuf","args":["Restaurants","Restaurants",null,null,["Le Quand-même","Paille Coco","River Grill","Bidjoul","Pause Café","Kung Kee","L'Embarcadére","Le Césaire","Le Corsaire",null,"Nautilux","Chez Marie Jo","Face à la mer","La Baraqu'Obama","Mango Bay","Boule de neige","Boule de Neige","Au Poisson d'Or","Aqua Grill","Ti Payot'","Taup'Créole",null,"Délices de la Mer","Hippopotamus","Pizz'Amis",null,"Le Coco Turquoise","Snack Régina","K'Bana","La Croisière","Pizza Express","Cantine scolaire","Le Petitbonum","Chez Jacko","L' Imprévue","Chez les Pêcheurs","Le Beach Grill",null,"LE WILLKAT","Pizzeria","Le Lotus Iléen","Kebab","Au Dessous Du Volcan","Au Soleil Couchant","Restaurant Le Littoral","Caramel Coffee Restaurant","Diamant Les Bains","Shing Kee","Li Fong","Neuvo Mejico","Pizzeria Creperie","Kebab","Bayfront Hotel Restaurant","Le Back Flip","Kebab","Roda Traiteur",null,"The Yellow","Brasserie Du Théatre","Le Dome Restaurant","Rita's","Remy Pizza",null,"Numéro 20","Nid Tropical","Le Zanzibar","Le Sextant","Ô Blé Noir","La Luciole",null,null,"New Cap","Ernest",null,null,"Le Tamaya","Chez Gato","Le Fruit de la Patience","Malibu Kfe",null,null,"Le Phare",null,null,"Steack House BBQ",null,null,null,null,null,null,null,null,null,null,"Le Fromager","Bonne Chance","Le Café de Paris","Les Deux Rivières","Dragon de Chine","La Sirène","L'Explorateur","La Marine","Ice'N Coffee",null,"DKlé","Le Toucan","Titiris","Le 62",null,"Le Deck","Le Figuier","Le Green","Cajou","Le Club",null,null,"Anba Fey Tol La","Ti Trésor Gourmand","La Cour Créole","Caribbean Food beach Restaurant",null,"Pura Vida","La Fazenda","Le Cayali","Ti sable",null,"L'encas Snack","Centre de saveur","Chez Nestor",null,"Le Jardin des Envies","la Mandoline","Pineapple","La Bonne Heure","Carioca","Saveurs Orientales","Le Maéva","Les 3 V","Pignon Nouvelle Vague",null,"Deliss' Snack","Marie Jo","Le Sable d'Or",null,"Chez Nini","Café Bohême","La Tartanaise","La Yole","Chino Créola","Point de Rencontre","Madin'Pizza","Bristol Place","Perle Bleue Beach","Le Liv'","Marin Mouillage","Delim's","O'Peyi Martinik","Chez Lucie","People Beach","Pizza Peyi","Pirates Beach",null,"Flouo Floup","Grill Riverain","La Table du Boulanger","Le P'Ti Bateau","L'Amandier des Îles","Man Nita","L'Escale","Mat'Iwel","Lari Z'abime","Kebab Café","Café Milano",null,"Boléro Club","Délys Kréyol",null,null,"Valy et le Pêcheur","La Kay","Kaban'Ylan","Chez Sanyata","Au Pied du Morne Champagne","Oriental City","Open Pizza",null,"La Cabane de Macou'Jah",null,"Le Zandoli","Samcielô",null,"O China Food","La Fée Sylda","P 31","La Cazasandwichs","Big Fernand","Le Saladier Bio","Chez Billy","Les Arômes","Caribeen Snack","P'Pita","King Kebab",null,null,"Les Lucioles","Hello Beyrouth",null,"La Dunette",null,null],{"radius":6,"stroke":true,"color":"#FFFFFF","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#940000","fillOpacity":90},{"className":"","pane":"point"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addLegend","args":[{"colors":["#940000"],"labels":["Restaurants"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"Restaurants"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addFlatGeoBuf","args":["Communes","Communes",null,true,["L'Ajoupa-Bouillon","Les Anses-d'Arlet","Basse-Pointe","Le Carbet","Case-Pilote","Le Diamant","Ducos","Fonds-Saint-Denis","Fort-de-France","Le François","Grand'Rivière","Gros-Morne","Le Lamentin","Le Lorrain","Macouba","Le Marigot","Le Marin","Le Morne-Rouge","Le Prêcheur","Rivière-Pilote","Rivière-Salée","Le Robert","Saint-Esprit","Saint-Joseph","Saint-Pierre","Sainte-Anne","Sainte-Luce","Sainte-Marie","Schoelcher","La Trinité","Les Trois-Îlets","Le Vauclin","Le Morne-Vert","Bellefontaine"],{"radius":6,"stroke":true,"color":"#FFFFFF","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#ADD8E6","fillOpacity":0.5},{"className":"","pane":"polygon"},"mapview-popup",{"radius":{"to":[3,15],"from":[3,15]},"weight":{"to":[1,10],"from":[1,10]},"opacity":{"to":[0,1],"from":[0,1]},"fillOpacity":{"to":[0,1],"from":[0,1]}}]},{"method":"addLayersControl","args":["OpenStreetMap",["Restaurants","Communes"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#ADD8E6"],"labels":["Communes"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"Communes"}]},{"method":"addHomeButton","args":[-61.2291071648456,14.3955692428653,-60.8110413346827,14.8781005893583,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]}],"fitBounds":[14.3955692428653,-61.2291071648456,14.8781005893583,-60.8110413346827,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapitre2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sessioninfo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {},
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 3 Cartographie thématique avancée | Cartographie avec R</title>
  <meta name="description" content="Matériel pour le cours de cartographie avec R" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Matériel pour le cours de cartographie avec R" />
  <meta name="github-repo" content="rCarto/carto_avec_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 3 Cartographie thématique avancée | Cartographie avec R" />
  
  <meta name="twitter:description" content="Matériel pour le cours de cartographie avec R" />
  

<meta name="author" content="banner Timothée Giraud &amp; Hugues Pécout" />


<meta name="date" content="2019-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapitre2.html"/>
<link rel="next" href="sessioninfo.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cartographie avec R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapitre1.html"><a href="chapitre1.html"><i class="fa fa-check"></i><b>1</b> Les données spatiales</a><ul>
<li class="chapter" data-level="1.1" data-path="chapitre1.html"><a href="chapitre1.html#le-package-sf"><i class="fa fa-check"></i><b>1.1</b> Le package <code>sf</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="chapitre1.html"><a href="chapitre1.html#format-des-objets-spatiaux-sf"><i class="fa fa-check"></i><b>1.1.1</b> Format des objets spatiaux <code>sf</code></a></li>
<li class="chapter" data-level="1.1.2" data-path="chapitre1.html"><a href="chapitre1.html#import-export"><i class="fa fa-check"></i><b>1.1.2</b> Import / Export</a></li>
<li class="chapter" data-level="1.1.3" data-path="chapitre1.html"><a href="chapitre1.html#affichage-de-données"><i class="fa fa-check"></i><b>1.1.3</b> Affichage de données</a></li>
<li class="chapter" data-level="1.1.4" data-path="chapitre1.html"><a href="chapitre1.html#joindre-des-données"><i class="fa fa-check"></i><b>1.1.4</b> Joindre des données</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chapitre1.html"><a href="chapitre1.html#les-systèmes-de-projections"><i class="fa fa-check"></i><b>1.2</b> Les systèmes de projections</a><ul>
<li class="chapter" data-level="1.2.1" data-path="chapitre1.html"><a href="chapitre1.html#consulter-la-projection-dun-objet"><i class="fa fa-check"></i><b>1.2.1</b> Consulter la projection d’un objet</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapitre1.html"><a href="chapitre1.html#modifier-la-projection-dun-objet"><i class="fa fa-check"></i><b>1.2.2</b> Modifier la projection d’un objet</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapitre1.html"><a href="chapitre1.html#opérations-de-géotraitement"><i class="fa fa-check"></i><b>1.3</b> Opérations de géotraitement</a><ul>
<li class="chapter" data-level="1.3.1" data-path="chapitre1.html"><a href="chapitre1.html#sélection-par-attributs"><i class="fa fa-check"></i><b>1.3.1</b> Sélection par attributs</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapitre1.html"><a href="chapitre1.html#sélection-spatiale"><i class="fa fa-check"></i><b>1.3.2</b> Sélection spatiale</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapitre1.html"><a href="chapitre1.html#extraire-des-centroides"><i class="fa fa-check"></i><b>1.3.3</b> Extraire des centroides</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapitre1.html"><a href="chapitre1.html#créer-une-matrice-de-distances"><i class="fa fa-check"></i><b>1.3.4</b> Créer une matrice de distances</a></li>
<li class="chapter" data-level="1.3.5" data-path="chapitre1.html"><a href="chapitre1.html#agréger-des-polygones"><i class="fa fa-check"></i><b>1.3.5</b> Agréger des polygones</a></li>
<li class="chapter" data-level="1.3.6" data-path="chapitre1.html"><a href="chapitre1.html#agréger-des-polygones-en-fonction-dune-variable"><i class="fa fa-check"></i><b>1.3.6</b> Agréger des polygones en fonction d’une variable</a></li>
<li class="chapter" data-level="1.3.7" data-path="chapitre1.html"><a href="chapitre1.html#construire-une-zone-tampon"><i class="fa fa-check"></i><b>1.3.7</b> Construire une zone tampon</a></li>
<li class="chapter" data-level="1.3.8" data-path="chapitre1.html"><a href="chapitre1.html#réaliser-une-intersection"><i class="fa fa-check"></i><b>1.3.8</b> Réaliser une intersection</a></li>
<li class="chapter" data-level="1.3.9" data-path="chapitre1.html"><a href="chapitre1.html#compter-des-points-dans-un-polygone"><i class="fa fa-check"></i><b>1.3.9</b> Compter des points dans un polygone</a></li>
<li class="chapter" data-level="1.3.10" data-path="chapitre1.html"><a href="chapitre1.html#construire-des-polygones-de-voronoi"><i class="fa fa-check"></i><b>1.3.10</b> Construire des polygones de Voronoi</a></li>
<li class="chapter" data-level="1.3.11" data-path="chapitre1.html"><a href="chapitre1.html#construction-dobjets-sf"><i class="fa fa-check"></i><b>1.3.11</b> Construction d’objets sf</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapitre1.html"><a href="chapitre1.html#géocodage-dadresses"><i class="fa fa-check"></i><b>1.4</b> Géocodage d’adresses</a></li>
<li class="chapter" data-level="1.5" data-path="chapitre1.html"><a href="chapitre1.html#importer-des-données-osm"><i class="fa fa-check"></i><b>1.5</b> Importer des données OSM</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre2.html"><a href="chapitre2.html"><i class="fa fa-check"></i><b>2</b> Cartographie thématique</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre2.html"><a href="chapitre2.html#le-package-cartography"><i class="fa fa-check"></i><b>2.1</b> Le package <code>cartography</code></a></li>
<li class="chapter" data-level="2.2" data-path="chapitre2.html"><a href="chapitre2.html#représentations-usuelles"><i class="fa fa-check"></i><b>2.2</b> Représentations usuelles</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-symboles-proportionnels"><i class="fa fa-check"></i><b>2.2.1</b> Carte de symboles proportionnels</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapitre2.html"><a href="chapitre2.html#carte-choroplèthe"><i class="fa fa-check"></i><b>2.2.2</b> Carte choroplèthe</a></li>
<li class="chapter" data-level="2.2.3" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-typologie"><i class="fa fa-check"></i><b>2.2.3</b> Carte de typologie</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapitre2.html"><a href="chapitre2.html#combinaisons-de-représentations"><i class="fa fa-check"></i><b>2.3</b> Combinaisons de représentations</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-stocks-et-de-ratios"><i class="fa fa-check"></i><b>2.3.1</b> Carte de stocks et de ratios</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre2.html"><a href="chapitre2.html#carte-de-stocks-et-de-qualitative"><i class="fa fa-check"></i><b>2.3.2</b> Carte de stocks et de qualitative</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre2.html"><a href="chapitre2.html#mise-en-page"><i class="fa fa-check"></i><b>2.4</b> Mise en page</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chapitre2.html"><a href="chapitre2.html#habillage-complet"><i class="fa fa-check"></i><b>2.4.1</b> Habillage complet</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapitre2.html"><a href="chapitre2.html#flèche-dorientation"><i class="fa fa-check"></i><b>2.4.2</b> Flèche d’orientation</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapitre2.html"><a href="chapitre2.html#échelle"><i class="fa fa-check"></i><b>2.4.3</b> Échelle</a></li>
<li class="chapter" data-level="2.4.4" data-path="chapitre2.html"><a href="chapitre2.html#étiquettes"><i class="fa fa-check"></i><b>2.4.4</b> Étiquettes</a></li>
<li class="chapter" data-level="2.4.5" data-path="chapitre2.html"><a href="chapitre2.html#ajuster-les-marges-dune-figure"><i class="fa fa-check"></i><b>2.4.5</b> Ajuster les marges d’une figure</a></li>
<li class="chapter" data-level="2.4.6" data-path="chapitre2.html"><a href="chapitre2.html#centrer-la-carte-sur-une-région"><i class="fa fa-check"></i><b>2.4.6</b> Centrer la carte sur une région</a></li>
<li class="chapter" data-level="2.4.7" data-path="chapitre2.html"><a href="chapitre2.html#afficher-plusieurs-cartes-sur-la-même-figure"><i class="fa fa-check"></i><b>2.4.7</b> Afficher plusieurs cartes sur la même figure</a></li>
<li class="chapter" data-level="2.4.8" data-path="chapitre2.html"><a href="chapitre2.html#obtenir-un-ratio-de-figure-adapté"><i class="fa fa-check"></i><b>2.4.8</b> Obtenir un ratio de figure adapté</a></li>
<li class="chapter" data-level="2.4.9" data-path="chapitre2.html"><a href="chapitre2.html#ajouter-une-image-sur-une-carte"><i class="fa fa-check"></i><b>2.4.9</b> Ajouter une image sur une carte</a></li>
<li class="chapter" data-level="2.4.10" data-path="chapitre2.html"><a href="chapitre2.html#placer-précisément-un-élément-sur-la-carte"><i class="fa fa-check"></i><b>2.4.10</b> Placer précisément un élément sur la carte</a></li>
<li class="chapter" data-level="2.4.11" data-path="chapitre2.html"><a href="chapitre2.html#utiliser-un-fond-de-carte-osm"><i class="fa fa-check"></i><b>2.4.11</b> Utiliser un fond de carte OSM</a></li>
<li class="chapter" data-level="2.4.12" data-path="chapitre2.html"><a href="chapitre2.html#créer-un-effet-crayonné"><i class="fa fa-check"></i><b>2.4.12</b> Créer un effet crayonné</a></li>
<li class="chapter" data-level="2.4.13" data-path="chapitre2.html"><a href="chapitre2.html#ajouter-un-ombrage-à-une-couche"><i class="fa fa-check"></i><b>2.4.13</b> Ajouter un ombrage à une couche</a></li>
<li class="chapter" data-level="2.4.14" data-path="chapitre2.html"><a href="chapitre2.html#création-de-cartons"><i class="fa fa-check"></i><b>2.4.14</b> Création de cartons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre3.html"><a href="chapitre3.html"><i class="fa fa-check"></i><b>3</b> Cartographie thématique avancée</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre3.html"><a href="chapitre3.html#les-cartes-de-discontinuités"><i class="fa fa-check"></i><b>3.1</b> Les cartes de discontinuités</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre3.html"><a href="chapitre3.html#les-grilles-régulières"><i class="fa fa-check"></i><b>3.2</b> Les grilles régulières</a></li>
<li class="chapter" data-level="3.3" data-path="chapitre3.html"><a href="chapitre3.html#le-lissage-spatial"><i class="fa fa-check"></i><b>3.3</b> Le lissage spatial</a></li>
<li class="chapter" data-level="3.4" data-path="chapitre3.html"><a href="chapitre3.html#cartes-en-3d"><i class="fa fa-check"></i><b>3.4</b> Cartes en 3D</a><ul>
<li class="chapter" data-level="3.4.1" data-path="chapitre3.html"><a href="chapitre3.html#linemap"><i class="fa fa-check"></i><b>3.4.1</b> linemap</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapitre3.html"><a href="chapitre3.html#relief-tanaka"><i class="fa fa-check"></i><b>3.4.2</b> Relief Tanaka</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapitre3.html"><a href="chapitre3.html#rayshader"><i class="fa fa-check"></i><b>3.4.3</b> Rayshader</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes"><i class="fa fa-check"></i><b>3.5</b> Les cartogrammes</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-de-dorling"><i class="fa fa-check"></i><b>3.5.1</b> Les cartogrammes de Dorling</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-non-continus"><i class="fa fa-check"></i><b>3.5.2</b> Les cartogrammes non continus</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-continus"><i class="fa fa-check"></i><b>3.5.3</b> Les cartogrammes continus</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapitre3.html"><a href="chapitre3.html#forces-et-faiblesses-des-cartogrammes"><i class="fa fa-check"></i><b>3.5.4</b> Forces et faiblesses des cartogrammes</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre3.html"><a href="chapitre3.html#cartographie-interactive"><i class="fa fa-check"></i><b>3.6</b> Cartographie interactive</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i><b>4</b> <code>sessionInfo()</code></a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rCarto/carto_avec_r" target="blank">Contribuer</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cartographie avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre3" class="section level1">
<h1><span class="header-section-number">Chapitre 3</span> Cartographie thématique avancée</h1>
<div id="les-cartes-de-discontinuités" class="section level2">
<h2><span class="header-section-number">3.1</span> Les cartes de discontinuités</h2>
<p>Ce type de représentation permet de souligner cartographiquement les discontinuités territoriales d’un phénomène. L’accent est porté sur ce qui distingue des territoires. Pour chaque frontière nous calculons le rapports ou la différence des valeurs des polygones de part et d’autre. Puis nous représentons la frontière par un figuré d’autant plus épais que la différence est forte. Il est souvent bénéfique de coupler ce type de représentation à une représentation choroplèthe (pour comprendre le sens des discontinuités).</p>
<p><img src="img/discmet.png" width="500" style="display: block; margin: auto;" /></p>
<p><img src="img/disc2.png" width="420" style="display: block; margin: auto;" /></p>

<div class="rmdmoins">
Ces cartes ne sont pas évidentes à paramétrer. Le choix des critères (seuil, type de différences…) influence fortement la représentation. En fonction du maillage utilisé la lisibilité de la carte peut être faible.
</div>


<div class="rmdplus">
Ces représentations sont très puissantes pour montrer les inégalités.
</div>

<p>La fonctions <code>getBorder()</code> du package <code>cartography</code> permet de construire une couche des frontières terrestres. La fonction <code>discLayer()</code> permet d’afficher les discontinuités.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="kw">library</span>(cartography)</a>
<a class="sourceLine" id="cb94-3" data-line-number="3">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb94-4" data-line-number="4"><span class="co"># Get borders</span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5">mtq_bord &lt;-<span class="st"> </span><span class="kw">getBorders</span>(<span class="dt">x =</span> mtq)</a>
<a class="sourceLine" id="cb94-6" data-line-number="6"><span class="co"># Plot polygons</span></a>
<a class="sourceLine" id="cb94-7" data-line-number="7"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;grey60&quot;</span>)</a>
<a class="sourceLine" id="cb94-8" data-line-number="8"><span class="co"># Plot borders</span></a>
<a class="sourceLine" id="cb94-9" data-line-number="9"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb94-10" data-line-number="10">  <span class="kw">st_geometry</span>(mtq_bord), </a>
<a class="sourceLine" id="cb94-11" data-line-number="11">  <span class="dt">col =</span> <span class="kw">sample</span>(<span class="dt">x =</span> <span class="kw">rainbow</span>(<span class="kw">nrow</span>(mtq_bord))), </a>
<a class="sourceLine" id="cb94-12" data-line-number="12">  <span class="dt">lwd =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb94-13" data-line-number="13">  <span class="dt">add =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb94-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb94-15" data-line-number="15"><span class="kw">layoutLayer</span>(<span class="st">&quot;Frontières inter-communales&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>, <span class="dt">north =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb94-16" data-line-number="16">            <span class="dt">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/disc-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="co"># Compute the population density (inhab./km2) using sf::st_area()</span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2">mtq<span class="op">$</span>POPDENS &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="fl">1e6</span> <span class="op">*</span><span class="st"> </span>mtq<span class="op">$</span>POP <span class="op">/</span><span class="st"> </span><span class="kw">st_area</span>(mtq))</a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="co"># plot municipalities (only the backgroung color is plotted)</span></a>
<a class="sourceLine" id="cb95-4" data-line-number="4"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>, </a>
<a class="sourceLine" id="cb95-5" data-line-number="5">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">690574</span>, <span class="dv">745940</span>))</a>
<a class="sourceLine" id="cb95-6" data-line-number="6"><span class="co"># Plot the population density with custom breaks</span></a>
<a class="sourceLine" id="cb95-7" data-line-number="7"><span class="kw">choroLayer</span>(<span class="dt">x =</span> mtq, <span class="dt">var =</span> <span class="st">&quot;MED&quot;</span>,</a>
<a class="sourceLine" id="cb95-8" data-line-number="8">           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">min</span>(mtq<span class="op">$</span>MED), <span class="kw">seq</span>(<span class="dv">13000</span>, <span class="dv">21000</span>, <span class="dv">2000</span>), <span class="kw">max</span>(mtq<span class="op">$</span>MED)),</a>
<a class="sourceLine" id="cb95-9" data-line-number="9">           <span class="dt">col =</span> <span class="kw">carto.pal</span>(<span class="st">&quot;green.pal&quot;</span>, <span class="dv">6</span>),<span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb95-10" data-line-number="10">           <span class="dt">legend.pos =</span> <span class="st">&quot;topright&quot;</span>, <span class="dt">legend.title.txt =</span> <span class="st">&quot;Median Income</span><span class="ch">\n</span><span class="st">(euros)&quot;</span>,</a>
<a class="sourceLine" id="cb95-11" data-line-number="11">           <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb95-12" data-line-number="12"><span class="co"># Plot discontinuities</span></a>
<a class="sourceLine" id="cb95-13" data-line-number="13"><span class="kw">discLayer</span>(</a>
<a class="sourceLine" id="cb95-14" data-line-number="14">  <span class="dt">x =</span> mtq_bord, </a>
<a class="sourceLine" id="cb95-15" data-line-number="15">  <span class="dt">df =</span> mtq, </a>
<a class="sourceLine" id="cb95-16" data-line-number="16">  <span class="dt">var =</span> <span class="st">&quot;MED&quot;</span>,</a>
<a class="sourceLine" id="cb95-17" data-line-number="17">  <span class="dt">type =</span> <span class="st">&quot;rel&quot;</span>, </a>
<a class="sourceLine" id="cb95-18" data-line-number="18">  <span class="dt">method =</span> <span class="st">&quot;geom&quot;</span>, </a>
<a class="sourceLine" id="cb95-19" data-line-number="19">  <span class="dt">nclass =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb95-20" data-line-number="20">  <span class="dt">threshold =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb95-21" data-line-number="21">  <span class="dt">sizemin =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb95-22" data-line-number="22">  <span class="dt">sizemax =</span> <span class="dv">6</span>, </a>
<a class="sourceLine" id="cb95-23" data-line-number="23">  <span class="dt">col =</span> <span class="st">&quot;red4&quot;</span>,</a>
<a class="sourceLine" id="cb95-24" data-line-number="24">  <span class="dt">legend.values.rnd =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb95-25" data-line-number="25">  <span class="dt">legend.title.txt =</span> <span class="st">&quot;Relative</span><span class="ch">\n</span><span class="st">Discontinuities&quot;</span>, </a>
<a class="sourceLine" id="cb95-26" data-line-number="26">  <span class="dt">legend.pos =</span> <span class="st">&quot;right&quot;</span>,</a>
<a class="sourceLine" id="cb95-27" data-line-number="27">  <span class="dt">add =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb95-28" data-line-number="28">)</a>
<a class="sourceLine" id="cb95-29" data-line-number="29"><span class="co"># Layout</span></a>
<a class="sourceLine" id="cb95-30" data-line-number="30"><span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Wealth Disparities in Martinique, 2015&quot;</span>, </a>
<a class="sourceLine" id="cb95-31" data-line-number="31">            <span class="dt">author =</span>  <span class="kw">paste0</span>(<span class="st">&quot;cartography &quot;</span>, <span class="kw">packageVersion</span>(<span class="st">&quot;cartography&quot;</span>)),</a>
<a class="sourceLine" id="cb95-32" data-line-number="32">            <span class="dt">sources =</span> <span class="st">&quot;Sources: Insee and IGN, 2018&quot;</span>,</a>
<a class="sourceLine" id="cb95-33" data-line-number="33">            <span class="dt">frame =</span> <span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>, <span class="dt">tabtitle =</span> <span class="ot">TRUE</span>,<span class="dt">theme =</span> <span class="st">&quot;grey.pal&quot;</span>)</a>
<a class="sourceLine" id="cb95-34" data-line-number="34"><span class="co"># north arrow</span></a>
<a class="sourceLine" id="cb95-35" data-line-number="35"><span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topleft&quot;</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/disc2-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="les-grilles-régulières" class="section level2">
<h2><span class="header-section-number">3.2</span> Les grilles régulières</h2>
<p>La méthode du carroyage consiste à découper l’espace géographique en un maillage formé de carrés réguliers dans une projection donnée. La donnée est répartie sur ce quadrillage régulier au prorata de la surface représentée. Le quadrillage permet ainsi de s’affranchir des mailles administratives.</p>
<p><img src="img/caromet.png" width="500" style="display: block; margin: auto;" /></p>
<p><img src="img/grid.png" width="300" style="display: block; margin: auto;" />
<img src="img/grid.png" width="300" style="display: block; margin: auto;" /></p>

<div class="rmdmoins">
Ces représentation induisent une perte de précision. Les maillages produit n’ont pas de signification. La version simple (les valeurs sont redistribuées au prorata de la surface), implique une equirépartition du phénomène dans chaque unités.
</div>


<div class="rmdplus">
La comparaison de maillages différents, à plusieurs dates ou de différentes sources est rendue possible.
</div>

<p>La fonction <code>getGridLayer()</code> du package <code>cartography</code> permet de construire ces grilles régulières.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="kw">library</span>(cartography)</a>
<a class="sourceLine" id="cb96-3" data-line-number="3">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-4" data-line-number="4"><span class="co"># Plot dentsity of population </span></a>
<a class="sourceLine" id="cb96-5" data-line-number="5">mtq<span class="op">$</span>dens &lt;-<span class="st"> </span>mtq<span class="op">$</span>POP <span class="op">/</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">st_area</span>(mtq) <span class="op">/</span><span class="st"> </span>(<span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)) </a>
<a class="sourceLine" id="cb96-6" data-line-number="6">bks &lt;-<span class="st"> </span><span class="kw">getBreaks</span>(<span class="dt">v =</span> mtq<span class="op">$</span>dens, <span class="dt">method =</span> <span class="st">&quot;q6&quot;</span>)</a>
<a class="sourceLine" id="cb96-7" data-line-number="7">cols &lt;-<span class="st"> </span><span class="kw">carto.pal</span>(<span class="dt">pal1 =</span> <span class="st">&quot;taupe.pal&quot;</span>, <span class="dt">n1 =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb96-8" data-line-number="8"><span class="kw">choroLayer</span>(</a>
<a class="sourceLine" id="cb96-9" data-line-number="9">  <span class="dt">x =</span> mtq, </a>
<a class="sourceLine" id="cb96-10" data-line-number="10">  <span class="dt">var =</span> <span class="st">&quot;dens&quot;</span>, </a>
<a class="sourceLine" id="cb96-11" data-line-number="11">  <span class="dt">breaks =</span> bks, </a>
<a class="sourceLine" id="cb96-12" data-line-number="12">  <span class="dt">border =</span> <span class="st">&quot;burlywood3&quot;</span>, </a>
<a class="sourceLine" id="cb96-13" data-line-number="13">  <span class="dt">col =</span> cols, </a>
<a class="sourceLine" id="cb96-14" data-line-number="14">  <span class="dt">legend.pos =</span> <span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb96-15" data-line-number="15">  <span class="dt">legend.values.rnd =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb96-16" data-line-number="16">  <span class="dt">legend.title.txt =</span> <span class="st">&quot;Densité de population</span><span class="ch">\n</span><span class="st">(hab/km2)&quot;</span></a>
<a class="sourceLine" id="cb96-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb96-18" data-line-number="18"><span class="kw">layoutLayer</span>(<span class="st">&quot;Population en Martinique&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb96-19" data-line-number="19">            <span class="dt">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb96-20" data-line-number="20"><span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topleft&quot;</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/grid-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="co"># Création de la grille</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2">mygrid &lt;-<span class="st"> </span><span class="kw">getGridLayer</span>(</a>
<a class="sourceLine" id="cb97-3" data-line-number="3">  <span class="dt">x =</span> mtq, </a>
<a class="sourceLine" id="cb97-4" data-line-number="4">  <span class="dt">cellsize =</span> <span class="dv">10000</span> <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>, </a>
<a class="sourceLine" id="cb97-5" data-line-number="5">  <span class="dt">type =</span> <span class="st">&quot;hexagonal&quot;</span>, </a>
<a class="sourceLine" id="cb97-6" data-line-number="6">  <span class="dt">var =</span> <span class="st">&quot;POP&quot;</span></a>
<a class="sourceLine" id="cb97-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb97-8" data-line-number="8"><span class="co">## conversion from square meter to square kilometers</span></a>
<a class="sourceLine" id="cb97-9" data-line-number="9">mygrid<span class="op">$</span>densitykm &lt;-<span class="st"> </span>mygrid<span class="op">$</span>POP <span class="op">/</span><span class="st"> </span>(mygrid<span class="op">$</span>gridarea <span class="op">/</span><span class="st"> </span>(<span class="dv">1000</span> <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)) </a>
<a class="sourceLine" id="cb97-10" data-line-number="10"><span class="kw">choroLayer</span>(</a>
<a class="sourceLine" id="cb97-11" data-line-number="11">  <span class="dt">x =</span> mygrid, </a>
<a class="sourceLine" id="cb97-12" data-line-number="12">  <span class="dt">var =</span> <span class="st">&quot;densitykm&quot;</span>, </a>
<a class="sourceLine" id="cb97-13" data-line-number="13">  <span class="dt">breaks =</span> bks,</a>
<a class="sourceLine" id="cb97-14" data-line-number="14">  <span class="dt">border =</span> <span class="st">&quot;burlywood3&quot;</span>, </a>
<a class="sourceLine" id="cb97-15" data-line-number="15">  <span class="dt">col =</span> cols, </a>
<a class="sourceLine" id="cb97-16" data-line-number="16">  <span class="dt">legend.pos =</span> <span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb97-17" data-line-number="17">  <span class="dt">legend.values.rnd =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb97-18" data-line-number="18">  <span class="dt">legend.title.txt =</span> <span class="st">&quot;Densité de population</span><span class="ch">\n</span><span class="st">(hab/km2)&quot;</span></a>
<a class="sourceLine" id="cb97-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb97-20" data-line-number="20"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">lwd =</span> <span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&quot;#ffffff75&quot;</span>)</a>
<a class="sourceLine" id="cb97-21" data-line-number="21"><span class="kw">layoutLayer</span>(</a>
<a class="sourceLine" id="cb97-22" data-line-number="22">  <span class="dt">title =</span> <span class="st">&quot;Population en Martinique&quot;</span>,</a>
<a class="sourceLine" id="cb97-23" data-line-number="23">  <span class="dt">tabtitle=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb97-24" data-line-number="24">  <span class="dt">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, </a>
<a class="sourceLine" id="cb97-25" data-line-number="25">  <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb97-26" data-line-number="26">  <span class="dt">frame=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb97-27" data-line-number="27">  <span class="dt">scale =</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb97-28" data-line-number="28">)</a>
<a class="sourceLine" id="cb97-29" data-line-number="29"><span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topleft&quot;</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/grid-2.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="le-lissage-spatial" class="section level2">
<h2><span class="header-section-number">3.3</span> Le lissage spatial</h2>
<p>L’idée principale du lissage est de filtrer l’information pour révéler des structures spatiales sous-jacentes. C’est un ensemble de méthodes qui consistent à affecter aux points que l’on observe une valeur prenant en compte les valeurs de leur voisinage.
Il existe plusieurs méthodes de lissage (kde, potentiels…) plus ou moins paramétrables.
Cette méthode permet de passer d’une représentations de données ponctuelles vers la représentation d’une surface continue.</p>
<p><img src="img/liss1.png" width="400" style="display: block; margin: auto;" /></p>
<p><img src="img/liss2.png" width="500" style="display: block; margin: auto;" /></p>

<div class="rmdmoins">
Il est difficile de paramétrer correctement les fonctions de lissages.<br />
Elles doivent s’appuyer sur des hypothèses de comportement dans l’espace.<br />
La compréhension par un public large n’est pas évidente, il faut alors simplifier les légendes, la présentation de la méthode.
</div>


<div class="rmdplus">
Permet de faire ressortir des phénomènes spatiaux sous-jacents invisibles directement.<br />
Les cartes produites attirent l’oeil par leur originalité.<br />
Cette méthode permet de passer d’une représentation ponctuelle ou discontinue (dans un maillage) à une représentation continue s’affranchissant des maillages existants.
</div>

<p>La méthode utilisée ici est celle de l’estimation par noyau (KDE).</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="kw">library</span>(spatstat)</a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="kw">library</span>(maptools)</a>
<a class="sourceLine" id="cb98-4" data-line-number="4"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb98-5" data-line-number="5"><span class="co"># Import des données</span></a>
<a class="sourceLine" id="cb98-6" data-line-number="6">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/martinique.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb98-7" data-line-number="7">resto &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="dt">dsn =</span> <span class="st">&quot;data/resto.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb98-8" data-line-number="8">sigma =<span class="st"> </span><span class="dv">750</span></a>
<a class="sourceLine" id="cb98-9" data-line-number="9">res =<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="co"># Define an observation window</span></a>
<a class="sourceLine" id="cb98-11" data-line-number="11">w &lt;-<span class="st"> </span><span class="kw">as.owin</span>(<span class="kw">as</span>(<span class="kw">st_union</span>(<span class="kw">st_buffer</span>(mtq, <span class="dv">100</span>)), <span class="st">&quot;Spatial&quot;</span>))</a>
<a class="sourceLine" id="cb98-12" data-line-number="12"><span class="co"># sf to coords</span></a>
<a class="sourceLine" id="cb98-13" data-line-number="13">pts &lt;-<span class="st"> </span><span class="kw">st_coordinates</span>(resto)</a>
<a class="sourceLine" id="cb98-14" data-line-number="14"><span class="co"># Coords to ppp</span></a>
<a class="sourceLine" id="cb98-15" data-line-number="15">p &lt;-<span class="st"> </span><span class="kw">ppp</span>(pts[,<span class="dv">1</span>], pts[,<span class="dv">2</span>], <span class="dt">window=</span>w)</a>
<a class="sourceLine" id="cb98-16" data-line-number="16"><span class="co"># Compute KDE</span></a>
<a class="sourceLine" id="cb98-17" data-line-number="17">dens &lt;-<span class="st"> </span><span class="kw">density.ppp</span>(p, <span class="dt">sigma =</span> sigma, <span class="dt">eps =</span> res)</a>
<a class="sourceLine" id="cb98-18" data-line-number="18"><span class="co"># Image to raster (+ proj &amp; km2)</span></a>
<a class="sourceLine" id="cb98-19" data-line-number="19">result &lt;-<span class="st"> </span><span class="kw">raster</span>(dens, <span class="dt">crs =</span> <span class="kw">st_crs</span>(resto)[[<span class="dv">2</span>]]) <span class="op">*</span><span class="st"> </span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb98-20" data-line-number="20">result &lt;-<span class="st"> </span><span class="kw">mask</span>(result, mtq)</a>
<a class="sourceLine" id="cb98-21" data-line-number="21"><span class="co"># compute breaks</span></a>
<a class="sourceLine" id="cb98-22" data-line-number="22">bks &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">getBreaks</span>(<span class="kw">values</span>(result), <span class="dt">nclass =</span> <span class="dv">8</span>, <span class="dt">method =</span> <span class="st">&quot;arith&quot;</span>))</a>
<a class="sourceLine" id="cb98-23" data-line-number="23"><span class="co"># Color ramp</span></a>
<a class="sourceLine" id="cb98-24" data-line-number="24">cols &lt;-<span class="st"> </span>mapview<span class="op">::</span><span class="kw">mapviewGetOption</span>(<span class="st">&quot;raster.palette&quot;</span>)(<span class="dv">10</span>)[<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>]</a>
<a class="sourceLine" id="cb98-25" data-line-number="25"><span class="co"># Plot the map</span></a>
<a class="sourceLine" id="cb98-26" data-line-number="26"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="st">&quot;lightblue4&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;lightblue3&quot;</span>, </a>
<a class="sourceLine" id="cb98-27" data-line-number="27">     <span class="dt">bg =</span> <span class="st">&quot;lightblue1&quot;</span>)</a>
<a class="sourceLine" id="cb98-28" data-line-number="28"><span class="kw">plot</span>(result, <span class="dt">breaks =</span> bks, <span class="dt">col=</span>cols, <span class="dt">add =</span> T,<span class="dt">legend=</span>F)</a>
<a class="sourceLine" id="cb98-29" data-line-number="29"><span class="kw">plot</span>(resto<span class="op">$</span>geom, <span class="dt">add=</span>T, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">cex =</span> <span class="fl">0.01</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb98-30" data-line-number="30"><span class="kw">legendChoro</span>(</a>
<a class="sourceLine" id="cb98-31" data-line-number="31">  <span class="dt">pos =</span> <span class="st">&quot;topright&quot;</span>,</a>
<a class="sourceLine" id="cb98-32" data-line-number="32">  <span class="dt">title.txt =</span> <span class="st">&quot;Densité de</span><span class="ch">\n</span><span class="st">restaurants</span><span class="ch">\n</span><span class="st">(N./km2)&quot;</span>,</a>
<a class="sourceLine" id="cb98-33" data-line-number="33">  <span class="dt">breaks =</span> bks, </a>
<a class="sourceLine" id="cb98-34" data-line-number="34">  <span class="dt">nodata =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb98-35" data-line-number="35">  <span class="dt">values.rnd =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb98-36" data-line-number="36">  <span class="dt">col =</span> cols</a>
<a class="sourceLine" id="cb98-37" data-line-number="37">)</a>
<a class="sourceLine" id="cb98-38" data-line-number="38"><span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Répartition des restaurants&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb98-39" data-line-number="39">            <span class="dt">author=</span> <span class="st">&quot;INSEE, 2016 - OSM, 2018&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb98-40" data-line-number="40">            <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-41" data-line-number="41"><span class="kw">north</span>(<span class="dt">pos =</span> <span class="st">&quot;topleft&quot;</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/kde-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="cartes-en-3d" class="section level2">
<h2><span class="header-section-number">3.4</span> Cartes en 3D</h2>
<div id="linemap" class="section level3">
<h3><span class="header-section-number">3.4.1</span> linemap</h3>
<p>Le package <code>linemap</code> <span class="citation">(Giraud <a href="#ref-R-linemap">2017</a><a href="#ref-R-linemap">a</a>)</span> permet de réaliser des cartes composées de lignes.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">library</span>(linemap)</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="kw">data</span>(<span class="st">&quot;popOcc&quot;</span>)</a>
<a class="sourceLine" id="cb99-4" data-line-number="4"><span class="kw">data</span>(<span class="st">&quot;occitanie&quot;</span>)</a>
<a class="sourceLine" id="cb99-5" data-line-number="5">opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">bg =</span> <span class="st">&quot;ivory2&quot;</span>)</a>
<a class="sourceLine" id="cb99-6" data-line-number="6">bb &lt;-<span class="st"> </span><span class="kw">st_bbox</span>(occitanie)</a>
<a class="sourceLine" id="cb99-7" data-line-number="7"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(occitanie), <span class="dt">col=</span><span class="st">&quot;ivory1&quot;</span>, <span class="dt">border =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb99-8" data-line-number="8"><span class="kw">linemap</span>(</a>
<a class="sourceLine" id="cb99-9" data-line-number="9">  <span class="dt">x =</span> popOcc, </a>
<a class="sourceLine" id="cb99-10" data-line-number="10">  <span class="dt">var =</span> <span class="st">&quot;pop&quot;</span>, </a>
<a class="sourceLine" id="cb99-11" data-line-number="11">  <span class="dt">k =</span> <span class="fl">2.5</span>, </a>
<a class="sourceLine" id="cb99-12" data-line-number="12">  <span class="dt">threshold =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb99-13" data-line-number="13">  <span class="dt">col =</span> <span class="st">&quot;ivory1&quot;</span>, </a>
<a class="sourceLine" id="cb99-14" data-line-number="14">  <span class="dt">border =</span> <span class="st">&quot;ivory4&quot;</span>, </a>
<a class="sourceLine" id="cb99-15" data-line-number="15">  <span class="dt">lwd =</span> <span class="fl">0.6</span>, </a>
<a class="sourceLine" id="cb99-16" data-line-number="16">  <span class="dt">add =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb99-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb99-18" data-line-number="18"><span class="kw">text</span>(<span class="dt">x =</span> bb[<span class="dv">1</span>], <span class="dt">y =</span> bb[<span class="dv">4</span>],<span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb99-19" data-line-number="19">     <span class="dt">labels =</span> <span class="st">&quot;Répartition de la</span><span class="ch">\n</span><span class="st">population</span><span class="ch">\n</span><span class="st">en Occitanie&quot;</span>,  </a>
<a class="sourceLine" id="cb99-20" data-line-number="20">     <span class="dt">col =</span> <span class="st">&quot;ivory4&quot;</span>, <span class="dt">font =</span> <span class="dv">2</span>,  <span class="dt">cex =</span> <span class="fl">1.8</span>)</a>
<a class="sourceLine" id="cb99-21" data-line-number="21"><span class="co"># add sources</span></a>
<a class="sourceLine" id="cb99-22" data-line-number="22">mapsources &lt;-<span class="st">&quot;Timothée Giraud</span><span class="ch">\n</span><span class="st">R 3.4.1, cartography 2.0.0, linemap 0.1.0</span><span class="ch">\n</span><span class="st">Données carroyées à 1 kilomètre, INSEE 2010&quot;</span></a>
<a class="sourceLine" id="cb99-23" data-line-number="23"><span class="kw">text</span>(<span class="dt">x =</span> bb[<span class="dv">3</span>], <span class="dt">y =</span> bb[<span class="dv">2</span>],<span class="dt">labels =</span> mapsources,  </a>
<a class="sourceLine" id="cb99-24" data-line-number="24">     <span class="dt">col =</span> <span class="st">&quot;ivory4&quot;</span>, <span class="dt">font =</span> <span class="dv">3</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">cex =</span> <span class="fl">0.6</span> )</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/lines-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="relief-tanaka" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Relief Tanaka</h3>
<p>Cette méthode <span class="citation">(Tanaka <a href="#ref-Tanaka50">1950</a>)</span> est utilisée pour améliorer la perception du relief.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb100-2" data-line-number="2"><span class="kw">library</span>(cartography)</a>
<a class="sourceLine" id="cb100-3" data-line-number="3"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb100-4" data-line-number="4"><span class="kw">library</span>(SpatialPosition)</a>
<a class="sourceLine" id="cb100-5" data-line-number="5">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb100-6" data-line-number="6"><span class="co"># use WGS84 proj</span></a>
<a class="sourceLine" id="cb100-7" data-line-number="7">mtq_latlon &lt;-<span class="st"> </span><span class="kw">st_transform</span>(mtq, <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb100-8" data-line-number="8"><span class="co"># import raster</span></a>
<a class="sourceLine" id="cb100-9" data-line-number="9">ras &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;data/srtm_24_10.tif&quot;</span>)</a>
<a class="sourceLine" id="cb100-10" data-line-number="10"><span class="co"># crop on martinique area</span></a>
<a class="sourceLine" id="cb100-11" data-line-number="11">mtq_ras &lt;-<span class="st"> </span><span class="kw">crop</span>(ras, <span class="kw">st_bbox</span>(mtq_latlon)[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)])</a>
<a class="sourceLine" id="cb100-12" data-line-number="12"><span class="co"># aggregate the raster</span></a>
<a class="sourceLine" id="cb100-13" data-line-number="13">mtq_ras &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mtq_ras, <span class="dt">fact=</span><span class="dv">4</span>, <span class="dt">fun=</span>mean)</a>
<a class="sourceLine" id="cb100-14" data-line-number="14">mtq_ras &lt;-<span class="st"> </span><span class="kw">projectRaster</span>(mtq_ras, <span class="dt">crs=</span><span class="kw">st_crs</span>(mtq)<span class="op">$</span>proj4string)</a>
<a class="sourceLine" id="cb100-15" data-line-number="15"><span class="co"># break values</span></a>
<a class="sourceLine" id="cb100-16" data-line-number="16">bv &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1300</span>,<span class="dv">100</span>),<span class="dv">1339</span>)</a>
<a class="sourceLine" id="cb100-17" data-line-number="17"><span class="co"># contour extraction</span></a>
<a class="sourceLine" id="cb100-18" data-line-number="18">mtq_cont &lt;-<span class="st"> </span><span class="kw">rasterToContourPoly</span>(<span class="dt">r =</span> mtq_ras, <span class="dt">breaks =</span> bv, </a>
<a class="sourceLine" id="cb100-19" data-line-number="19">                                <span class="dt">mask =</span> <span class="kw">as</span>(mtq, <span class="st">&quot;Spatial&quot;</span>))</a>
<a class="sourceLine" id="cb100-20" data-line-number="20"><span class="co"># custom palette</span></a>
<a class="sourceLine" id="cb100-21" data-line-number="21">pal &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#5D9D52&quot;</span>, <span class="st">&quot;#8DBC80&quot;</span>, <span class="st">&quot;#B8D9A9&quot;</span>, <span class="st">&quot;#FDEBBE&quot;</span>, <span class="st">&quot;#F7E0AC&quot;</span>, <span class="st">&quot;#F2D69B&quot;</span>, </a>
<a class="sourceLine" id="cb100-22" data-line-number="22">         <span class="st">&quot;#EDCC8A&quot;</span>, <span class="st">&quot;#E8C279&quot;</span>, <span class="st">&quot;#E2B563&quot;</span>, <span class="st">&quot;#DBA84C&quot;</span>, <span class="st">&quot;#D49B36&quot;</span>, <span class="st">&quot;#BA8428&quot;</span>, </a>
<a class="sourceLine" id="cb100-23" data-line-number="23">         <span class="st">&quot;#9A6A1E&quot;</span>, <span class="st">&quot;#7B5114&quot;</span>)</a>
<a class="sourceLine" id="cb100-24" data-line-number="24"><span class="co"># sp to sf</span></a>
<a class="sourceLine" id="cb100-25" data-line-number="25">k &lt;-<span class="st"> </span><span class="kw">st_as_sf</span>(mtq_cont)</a>
<a class="sourceLine" id="cb100-26" data-line-number="26"><span class="co"># order the sf</span></a>
<a class="sourceLine" id="cb100-27" data-line-number="27">k &lt;-<span class="st"> </span>k[<span class="kw">order</span>(k<span class="op">$</span>center),]</a>
<a class="sourceLine" id="cb100-28" data-line-number="28"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</a>
<a class="sourceLine" id="cb100-29" data-line-number="29"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(k)){</a>
<a class="sourceLine" id="cb100-30" data-line-number="30">  p &lt;-<span class="st"> </span><span class="kw">st_geometry</span>(k[i,])</a>
<a class="sourceLine" id="cb100-31" data-line-number="31">  <span class="kw">plot</span>(p <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">50</span>), <span class="dt">add=</span>T, <span class="dt">border =</span> <span class="st">&quot;#ffffff90&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;#ffffff90&quot;</span>)</a>
<a class="sourceLine" id="cb100-32" data-line-number="32">  <span class="kw">plot</span>(p <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">-100</span>),  <span class="dt">col =</span> <span class="st">&quot;#00000090&quot;</span>, <span class="dt">add=</span>T, <span class="dt">border =</span> <span class="st">&quot;#00000090&quot;</span>)</a>
<a class="sourceLine" id="cb100-33" data-line-number="33">  <span class="kw">plot</span>(p, <span class="dt">col =</span> pal[i], <span class="dt">border =</span> <span class="st">&quot;NA&quot;</span>, <span class="dt">add=</span>T)  </a>
<a class="sourceLine" id="cb100-34" data-line-number="34">}</a>
<a class="sourceLine" id="cb100-35" data-line-number="35"><span class="kw">legendChoro</span>(<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">689000</span>,<span class="dv">1598000</span> ), <span class="dt">breaks =</span> bv, <span class="dt">col =</span> pal, <span class="dt">nodata =</span> F,</a>
<a class="sourceLine" id="cb100-36" data-line-number="36">            <span class="dt">title.txt =</span> <span class="st">&quot;Elevation</span><span class="ch">\n</span><span class="st">(metres)&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb100-37" data-line-number="37"><span class="kw">layoutLayer</span>(<span class="dt">title =</span> <span class="st">&quot;Martinique Relief&quot;</span>, <span class="dt">north =</span> T,</a>
<a class="sourceLine" id="cb100-38" data-line-number="38">            <span class="dt">sources =</span> <span class="st">&#39;T. Giraud, 2019&#39;</span>, <span class="dt">author =</span> <span class="st">&quot;SRTM, 2018&quot;</span>, </a>
<a class="sourceLine" id="cb100-39" data-line-number="39">            <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, </a>
<a class="sourceLine" id="cb100-40" data-line-number="40">            <span class="dt">tabtitle =</span> T, <span class="dt">coltitle =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/tanaka-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="rayshader" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Rayshader</h3>
<p>Le package <code>rayshader</code> <span class="citation">(Morgan-Wall <a href="#ref-R-rayshader">2018</a>)</span> permet de réaliser de belles cartes en relief.
L’export des images n’est pas évident, il s’agit ici d’une simple capture d’écran.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="kw">library</span>(rayshader)</a>
<a class="sourceLine" id="cb101-4" data-line-number="4">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb101-5" data-line-number="5"><span class="kw">st_geometry</span>(mtq) &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(<span class="kw">st_geometry</span>(mtq), <span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb101-6" data-line-number="6">mtq_latlon &lt;-<span class="st"> </span><span class="kw">st_transform</span>(mtq, <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb101-7" data-line-number="7">ras &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;data/srtm_24_10.tif&quot;</span>)</a>
<a class="sourceLine" id="cb101-8" data-line-number="8">mtq_ras &lt;-<span class="st"> </span><span class="kw">crop</span>(ras, <span class="kw">st_bbox</span>(mtq_latlon)[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)])</a>
<a class="sourceLine" id="cb101-9" data-line-number="9">mtq_ras &lt;-<span class="st"> </span><span class="kw">projectRaster</span>(mtq_ras, <span class="dt">crs=</span><span class="kw">st_crs</span>(mtq)<span class="op">$</span>proj4string)</a>
<a class="sourceLine" id="cb101-10" data-line-number="10">elmat =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">extract</span>(mtq_ras,<span class="kw">extent</span>(mtq_ras),<span class="dt">buffer=</span><span class="dv">1000</span>),</a>
<a class="sourceLine" id="cb101-11" data-line-number="11">               <span class="dt">nrow=</span><span class="kw">ncol</span>(mtq_ras),<span class="dt">ncol=</span><span class="kw">nrow</span>(mtq_ras))</a>
<a class="sourceLine" id="cb101-12" data-line-number="12">elmat[<span class="kw">is.na</span>(elmat)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb101-13" data-line-number="13">raymat =<span class="st"> </span><span class="kw">ray_shade</span>(elmat,<span class="dt">lambert =</span> <span class="ot">TRUE</span>,<span class="dt">anglebreaks =</span> <span class="dv">85</span>,<span class="dt">sunangle =</span> <span class="dv">125</span>)</a>
<a class="sourceLine" id="cb101-14" data-line-number="14">ambmat =<span class="st"> </span><span class="kw">ambient_shade</span>(elmat,<span class="dt">anglebreaks =</span>  <span class="dv">85</span>)</a>
<a class="sourceLine" id="cb101-15" data-line-number="15">elmat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-16" data-line-number="16"><span class="st">  </span><span class="kw">sphere_shade</span>(<span class="dt">texture =</span> <span class="st">&quot;imhof1&quot;</span>,<span class="dt">sunangle =</span> <span class="dv">125</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-17" data-line-number="17"><span class="st">  </span><span class="kw">add_water</span>(<span class="kw">detect_water</span>(elmat), <span class="dt">color=</span><span class="st">&quot;desert&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-18" data-line-number="18"><span class="st">  </span><span class="kw">add_shadow</span>(raymat,<span class="fl">0.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-19" data-line-number="19"><span class="st">  </span><span class="kw">add_shadow</span>(ambmat,<span class="fl">0.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb101-20" data-line-number="20"><span class="st">  </span><span class="kw">plot_3d</span>(elmat,<span class="dt">zscale=</span><span class="dv">25</span>,<span class="dt">fov=</span><span class="dv">10</span>,<span class="dt">theta=</span><span class="op">-</span><span class="dv">15</span>,<span class="dt">phi=</span><span class="dv">70</span>, <span class="dt">background=</span><span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb101-21" data-line-number="21">          <span class="dt">zoom=</span>.<span class="dv">5</span>, <span class="dt">windowsize =</span><span class="kw">c</span>(<span class="dv">900</span>, <span class="dv">900</span>))</a></code></pre></div>
<p><img src="img/rayshade.png" width="735" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="les-cartogrammes" class="section level2">
<h2><span class="header-section-number">3.5</span> Les cartogrammes</h2>
<blockquote>
<p>L’anamorphose classique est une représentation des États (ou de mailles quelconques) par <strong>des rectangles ou des polygones quelconques</strong> en fonction d’une <strong>quantité</strong> qui leur est rattaché. (…)
On s’efforce de <strong>garder l’arrangement général</strong> des mailles ou la silhouette du continent.&quot;<br />
<span class="citation">Brunet, Ferras, and Théry (<a href="#ref-Brunet93">1993</a>)</span></p>
</blockquote>
<p>3 types d’anamorphoses ou cartogrammes sont ici présentés :</p>
<ul>
<li>Les cartogrammes de Dorling <span class="citation">(Dorling <a href="#ref-Dorling96">1996</a>)</span></li>
<li>Les cartogrammes non contigus <span class="citation">(Olson <a href="#ref-Olson76">1976</a>)</span></li>
<li>Les cartogrammes contigus <span class="citation">(Dougenik, Chrisman, and Niemeyer <a href="#ref-Dougenik85">1985</a>)</span></li>
</ul>
<p>Vous trouverez un cours complet sur les anamorphoses ici : <a href="https://neocarto.hypotheses.org/366" target="_blank">Les anamorphoses cartographiques</a> <span class="citation">(Lambert <a href="#ref-Lambert15">2015</a>)</span>.</p>
<p>Pour réaliser les cartogrammes nous utilisons le package <code>cartogram</code> <span class="citation">(Jeworutzki <a href="#ref-R-cartogram">2018</a>)</span>.</p>
<div id="les-cartogrammes-de-dorling" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Les cartogrammes de Dorling</h3>
<p>Les territoires sont représentés par des figurés (cercles, des carrés ou des rectangles) ne se recouvrant pas dont les surfaces sont proportionnelles à une variable. Les positions des figurés sont définie selon les positions de départ.</p>
<p><img src="img/dorling.png" width="602" style="display: block; margin: auto;" />
<span class="citation">(McCormick <a href="#ref-McCormick07">2017</a>)</span></p>

<div class="rmdmoins">
On identifie assez mal l’espace.<br />
On peut nommer les cercles pour se repérer et/ou s’aider de la couleur pour faire apparaitre des clusters et mieux identifier les blocks géographiques.
</div>


<div class="rmdplus">
La perception des quantités est très bonne.<br />
Les tailles de cercles sont vraiment comparables.
</div>

<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">library</span>(cartography)</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="kw">library</span>(cartogram)</a>
<a class="sourceLine" id="cb102-3" data-line-number="3"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb102-4" data-line-number="4">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb102-5" data-line-number="5">mtq_dorling &lt;-<span class="st"> </span><span class="kw">cartogram_dorling</span>(<span class="dt">x =</span> mtq, <span class="dt">weight =</span> <span class="st">&quot;POP&quot;</span>, <span class="dt">k =</span> <span class="dv">12</span>) </a>
<a class="sourceLine" id="cb102-6" data-line-number="6"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_dorling), <span class="dt">col =</span> <span class="st">&quot;#940000&quot;</span>, <span class="dt">border=</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</a>
<a class="sourceLine" id="cb102-7" data-line-number="7"><span class="kw">labelLayer</span>(<span class="dt">x =</span> mtq_dorling, <span class="dt">txt =</span> <span class="st">&quot;LIBGEO&quot;</span>, <span class="dt">overlap =</span> <span class="ot">FALSE</span>, <span class="dt">show.lines =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb102-8" data-line-number="8">           <span class="dt">halo =</span> <span class="ot">TRUE</span>, <span class="dt">r =</span> <span class="fl">.15</span>)</a>
<a class="sourceLine" id="cb102-9" data-line-number="9"><span class="kw">layoutLayer</span>(<span class="st">&quot;Population en Martinique - Cartogramme de Dorling&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb102-10" data-line-number="10">            <span class="dt">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/dorling-1.png" width="576" style="display: block; margin: auto;" />
Le paramètre <code>k</code> permet de faire varier le facteur d’expansion des cercles.</p>
</div>
<div id="les-cartogrammes-non-continus" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Les cartogrammes non continus</h3>
<p>La taille des polygones est proportionnelle à une variable. L’agencement des polygones les uns par rapport aux autres est conservée. La forme des polygones est ressemblante.</p>
<p><img src="img/nccartogram.png" width="272" style="display: block; margin: auto;" />
<span class="citation">(Cauvin, Escobar, and Serradj <a href="#ref-Cauvin13">2013</a>)</span></p>

<div class="rmdmoins">
La topologie des régions est perdue.
</div>


<div class="rmdplus">
La conservation de la forme des polygones est optimale.
</div>

<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">library</span>(cartography)</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="kw">library</span>(cartogram)</a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb103-4" data-line-number="4">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb103-5" data-line-number="5">mtq_ncont &lt;-<span class="st"> </span><span class="kw">cartogram_ncont</span>(<span class="dt">x =</span> mtq, <span class="dt">weight =</span> <span class="st">&quot;POP&quot;</span>, <span class="dt">k =</span> <span class="fl">1.5</span>) </a>
<a class="sourceLine" id="cb103-6" data-line-number="6"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</a>
<a class="sourceLine" id="cb103-7" data-line-number="7"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_ncont), <span class="dt">col =</span> <span class="st">&quot;#940000&quot;</span>, <span class="dt">border=</span> <span class="st">&quot;white&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb103-8" data-line-number="8"><span class="kw">layoutLayer</span>(<span class="st">&quot;Population en Martinique - Cartogramme de Olson&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb103-9" data-line-number="9">            <span class="dt">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/olson-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Le paramètre <code>k</code> permet de faire varier le facteur d’expansion des polygones.</p>
</div>
<div id="les-cartogrammes-continus" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Les cartogrammes continus</h3>
<p>La taille des polygones est proportionnelle à une variable. L’agencement des polygones les uns par rapport aux autres est conservée. Pour conserver la contiguité, la forme des polygones est fortement transformée.</p>
<p><img src="img/cartogram.jpg" width="960" style="display: block; margin: auto;" />
<span class="citation">(Paull and Hennig <a href="#ref-Paull16">2016</a>)</span></p>

<div class="rmdmoins">
La forme des polygones est fortement distordue.
</div>


<div class="rmdplus">
C’est une “vraie carte de géographie” : la topologie et la contiguité sont conservées.
</div>

<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">library</span>(cartography)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="kw">library</span>(cartogram)</a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb104-4" data-line-number="4">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="co"># transformation POLYGON =&gt; MULTIPOLYGON</span></a>
<a class="sourceLine" id="cb104-6" data-line-number="6">mtq &lt;-<span class="st"> </span><span class="kw">st_cast</span>(mtq, <span class="st">&quot;MULTIPOLYGON&quot;</span>)</a>
<a class="sourceLine" id="cb104-7" data-line-number="7">mtq_cont &lt;-<span class="st"> </span><span class="kw">cartogram_cont</span>(<span class="dt">x =</span> mtq, <span class="dt">weight =</span> <span class="st">&quot;POP&quot;</span>, <span class="dt">prepare =</span> <span class="st">&quot;none&quot;</span>) </a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_cont), <span class="dt">col =</span> <span class="st">&quot;#940000&quot;</span>, <span class="dt">border=</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;lightblue&quot;</span>)</a>
<a class="sourceLine" id="cb104-9" data-line-number="9"><span class="kw">layoutLayer</span>(<span class="st">&quot;Population en Martinique - Cartogramme de Dougenik&quot;</span>,<span class="dt">tabtitle=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb104-10" data-line-number="10">            <span class="dt">author=</span> <span class="st">&quot;INSEE 2016&quot;</span>, <span class="dt">sources=</span><span class="st">&quot;&quot;</span>, <span class="dt">frame=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="Cartographie_avec_R_files/figure-html/dougenik-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="forces-et-faiblesses-des-cartogrammes" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Forces et faiblesses des cartogrammes</h3>
<p>Les cartogrammes sont des représentations cartographiques perçues comme <strong>innovante</strong> (bien que la methode date de 40 ans). Ces images très généralisées rendent bien compte des <strong>quantités</strong> et des <strong>gradiants</strong>. Ce sont de vraies images de <strong>communication</strong> qui <strong>provoquent</strong>, suscitent <strong>l’intérêt</strong>, véhiculent un <strong>message</strong> fort, <strong>interpellent</strong>.</p>
<p>Mais les cartogrammes induisent une perte des <strong>repères visuels</strong> (difficile de retrouver son pays, ou sa région sur la carte), demandent un <strong>effort de lecture</strong> qui peut être important et ne permettent pas de <strong>gérer des données manquantes</strong>.</p>
</div>
</div>
<div id="cartographie-interactive" class="section level2">
<h2><span class="header-section-number">3.6</span> Cartographie interactive</h2>
<p>Le package <code>mapview</code> <span class="citation">(Appelhans et al. <a href="#ref-R-mapview">2018</a>)</span> utilise le package <code>leaflet</code> <span class="citation">(Cheng, Karambelkar, and Xie <a href="#ref-R-leaflet">2018</a>)</span> basé sur la librairie javascript Leaflet <span class="citation">(Agafonkin <a href="#ref-JS-Leaflet">2015</a>)</span> pour créer des cartes interactives. La création de carte est assez aisée, la documentation est un peu dense.</p>
<p><strong>Utilisation simple</strong></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="kw">library</span>(mapview)</a>
<a class="sourceLine" id="cb105-3" data-line-number="3">mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb105-4" data-line-number="4">resto &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="dt">dsn =</span> <span class="st">&quot;data/resto.gpkg&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb105-5" data-line-number="5"><span class="kw">mapview</span>(resto) <span class="op">+</span><span class="st"> </span><span class="kw">mapview</span>(mtq) </a></code></pre></div>
<p></br>
<strong>Utilisation personnalisée</strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">mapview</span>(</a>
<a class="sourceLine" id="cb106-2" data-line-number="2">  resto, </a>
<a class="sourceLine" id="cb106-3" data-line-number="3">  <span class="dt">map.types =</span> <span class="st">&quot;OpenStreetMap&quot;</span>, </a>
<a class="sourceLine" id="cb106-4" data-line-number="4">  <span class="dt">col.regions =</span> <span class="st">&quot;#940000&quot;</span>, </a>
<a class="sourceLine" id="cb106-5" data-line-number="5">  <span class="dt">label =</span> resto<span class="op">$</span>name,</a>
<a class="sourceLine" id="cb106-6" data-line-number="6">  <span class="dt">alpha.regions=</span><span class="dv">90</span>,</a>
<a class="sourceLine" id="cb106-7" data-line-number="7">  <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb106-8" data-line-number="8">  <span class="dt">legend =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb106-9" data-line-number="9">  <span class="dt">layer.name =</span> <span class="st">&quot;Restaurants&quot;</span>, </a>
<a class="sourceLine" id="cb106-10" data-line-number="10">  <span class="dt">homebutton =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb106-11" data-line-number="11">  <span class="dt">lwd =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb106-12" data-line-number="12">  <span class="dt">popup =</span> <span class="ot">NA</span></a>
<a class="sourceLine" id="cb106-13" data-line-number="13">) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-14" data-line-number="14"><span class="st">  </span><span class="kw">mapview</span>(</a>
<a class="sourceLine" id="cb106-15" data-line-number="15">    mtq, </a>
<a class="sourceLine" id="cb106-16" data-line-number="16">    <span class="dt">col.regions =</span> <span class="st">&quot;lightblue&quot;</span>, </a>
<a class="sourceLine" id="cb106-17" data-line-number="17">    <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb106-18" data-line-number="18">    <span class="dt">legend =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb106-19" data-line-number="19">    <span class="dt">label =</span> mtq<span class="op">$</span>LIBGEO, </a>
<a class="sourceLine" id="cb106-20" data-line-number="20">    <span class="dt">alpha.regions=</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb106-21" data-line-number="21">    <span class="dt">map.types =</span> <span class="st">&quot;OpenStreetMap&quot;</span>,</a>
<a class="sourceLine" id="cb106-22" data-line-number="22">    <span class="dt">lwd =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb106-23" data-line-number="23">    <span class="dt">layer.name =</span> <span class="st">&quot;Communes&quot;</span>,</a>
<a class="sourceLine" id="cb106-24" data-line-number="24">    <span class="dt">homebutton =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb106-25" data-line-number="25">    <span class="dt">popup =</span> <span class="kw">popupTable</span>(mtq, </a>
<a class="sourceLine" id="cb106-26" data-line-number="26">                       <span class="dt">zcol =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, </a>
<a class="sourceLine" id="cb106-27" data-line-number="27">                       <span class="dt">row.numbers =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb106-28" data-line-number="28">                       <span class="dt">feature.id =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb106-29" data-line-number="29">  )</a></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-JS-Leaflet">
<p>Agafonkin, Vladimir. 2015. “Leaflet Javascript Libary.”</p>
</div>
<div id="ref-R-mapview">
<p>Appelhans, Tim, Florian Detsch, Christoph Reudenbach, and Stefan Woellauer. 2018. <em>Mapview: Interactive Viewing of Spatial Data in R</em>. <a href="https://CRAN.R-project.org/package=mapview">https://CRAN.R-project.org/package=mapview</a>.</p>
</div>
<div id="ref-Brunet93">
<p>Brunet, Roger, Robert Ferras, and Hervé Théry. 1993. <em>Les Mots de La Géographie: Dictionnaire Critique</em>. 03) 911 BRU.</p>
</div>
<div id="ref-Cauvin13">
<p>Cauvin, Colette, Francisco Escobar, and Aziz Serradj. 2013. <em>Thematic Cartography, Cartography and the Impact of the Quantitative Revolution</em>. Vol. 2. John Wiley &amp; Sons.</p>
</div>
<div id="ref-R-leaflet">
<p>Cheng, Joe, Bhaskar Karambelkar, and Yihui Xie. 2018. <em>Leaflet: Create Interactive Web Maps with the Javascript ’Leaflet’ Library</em>. <a href="https://CRAN.R-project.org/package=leaflet">https://CRAN.R-project.org/package=leaflet</a>.</p>
</div>
<div id="ref-Dorling96">
<p>Dorling, Daniel. 1996. <em>Area Cartograms: Their Use and Creation, Concepts and Techniques in Modern Geography</em>. Vol. 59. CATMOG: Concepts and Techniques in Modern Geography. Institute of British Geographers.</p>
</div>
<div id="ref-Dougenik85">
<p>Dougenik, James A, Nicholas R Chrisman, and Duane R Niemeyer. 1985. “An Algorithm to Construct Continuous Area Cartograms.” <em>The Professional Geographer</em> 37 (1). Wiley Online Library: 75–81.</p>
</div>
<div id="ref-R-linemap">
<p>Giraud, Timothée. 2017a. <em>Linemap: Line Maps</em>. <a href="https://CRAN.R-project.org/package=linemap">https://CRAN.R-project.org/package=linemap</a>.</p>
</div>
<div id="ref-R-cartogram">
<p>Jeworutzki, Sebastian. 2018. <em>Cartogram: Create Cartograms with R</em>. <a href="https://CRAN.R-project.org/package=cartogram">https://CRAN.R-project.org/package=cartogram</a>.</p>
</div>
<div id="ref-Lambert15">
<p>Lambert, Nicolas. 2015. “Les Anamorphoses Cartographiques.” Blog. <em>Carnet Néocartographique</em>. <a href="https://neocarto.hypotheses.org/366">https://neocarto.hypotheses.org/366</a>.</p>
</div>
<div id="ref-McCormick07">
<p>McCormick, Mark. 2017. “Carbon Atlas.” <em>The Guardian</em>, December. <a href="http://kelsocartography.com/blog/wp-content/uploads/2008/03/carbonatlas.pdf">http://kelsocartography.com/blog/wp-content/uploads/2008/03/carbonatlas.pdf</a>.</p>
</div>
<div id="ref-R-rayshader">
<p>Morgan-Wall, Tyler. 2018. <em>Rayshader: Create and Visualize Hillshaded Maps from Elevation Matrices</em>. <a href="https://CRAN.R-project.org/package=rayshader">https://CRAN.R-project.org/package=rayshader</a>.</p>
</div>
<div id="ref-Olson76">
<p>Olson, Judy M. 1976. “Noncontiguous Area Cartograms.” <em>The Professional Geographer</em> 28 (4). Wiley Online Library: 371–80.</p>
</div>
<div id="ref-Paull16">
<p>Paull, John, and Benjamin Hennig. 2016. “Atlas of Organics: Four Maps of the World of Organic Agriculture.” <em>Journal of Organics</em> 3 (1): 25–32.</p>
</div>
<div id="ref-Tanaka50">
<p>Tanaka, Kitiro. 1950. “The Relief Contour Method of Representing Topography on Maps.” <em>The Geographical Review</em> xl (3).</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapitre2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sessioninfo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {},
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Cartographie_avec_R.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

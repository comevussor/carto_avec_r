<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapitre 1 Les données spatiales | Cartographie avec R</title>
  <meta name="description" content="Matériel pour le cours de cartographie avec R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapitre 1 Les données spatiales | Cartographie avec R />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cartomix.png" />
  <meta property="og:description" content="Matériel pour le cours de cartographie avec R" />
  <meta name="github-repo" content="rCarto/carto_avec_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 1 Les données spatiales | Cartographie avec R />
  
  <meta name="twitter:description" content="Matériel pour le cours de cartographie avec R" />
  <meta name="twitter:image" content="img/cartomix.png" />

<meta name="author" content="Timothée Giraud &amp; Hugues Pécout">


<meta name="date" content="2018-12-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="chapitre2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<link href="libs/PopupTable-0.0.1/popup.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cartographie avec R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="chapitre1.html"><a href="chapitre1.html"><i class="fa fa-check"></i><b>1</b> Les données spatiales</a><ul>
<li class="chapter" data-level="1.1" data-path="chapitre1.html"><a href="chapitre1.html#le-package-sf"><i class="fa fa-check"></i><b>1.1</b> Le package <code>sf</code></a><ul>
<li class="chapter" data-level="1.1.1" data-path="chapitre1.html"><a href="chapitre1.html#format-des-objets-spatiaux-sf"><i class="fa fa-check"></i><b>1.1.1</b> Format des objets spatiaux <code>sf</code></a></li>
<li class="chapter" data-level="1.1.2" data-path="chapitre1.html"><a href="chapitre1.html#construction-dun-objet-sf"><i class="fa fa-check"></i><b>1.1.2</b> Construction d’un objet sf</a></li>
<li class="chapter" data-level="1.1.3" data-path="chapitre1.html"><a href="chapitre1.html#import-export"><i class="fa fa-check"></i><b>1.1.3</b> Import / Export</a></li>
<li class="chapter" data-level="1.1.4" data-path="chapitre1.html"><a href="chapitre1.html#affichage-de-donnees"><i class="fa fa-check"></i><b>1.1.4</b> Affichage de données</a></li>
<li class="chapter" data-level="1.1.5" data-path="chapitre1.html"><a href="chapitre1.html#joindre-des-donnees"><i class="fa fa-check"></i><b>1.1.5</b> Joindre des données</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chapitre1.html"><a href="chapitre1.html#les-projections"><i class="fa fa-check"></i><b>1.2</b> Les projections</a></li>
<li class="chapter" data-level="1.3" data-path="chapitre1.html"><a href="chapitre1.html#operations-de-geotraitement"><i class="fa fa-check"></i><b>1.3</b> Opérations de géotraitement</a><ul>
<li class="chapter" data-level="1.3.1" data-path="chapitre1.html"><a href="chapitre1.html#selection-par-attributs"><i class="fa fa-check"></i><b>1.3.1</b> Selection par attributs</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapitre1.html"><a href="chapitre1.html#selection-spatiale"><i class="fa fa-check"></i><b>1.3.2</b> Selection spatiale</a></li>
<li class="chapter" data-level="1.3.3" data-path="chapitre1.html"><a href="chapitre1.html#extraire-des-centroides"><i class="fa fa-check"></i><b>1.3.3</b> Extraire des centroides</a></li>
<li class="chapter" data-level="1.3.4" data-path="chapitre1.html"><a href="chapitre1.html#creer-une-matrice-de-distances"><i class="fa fa-check"></i><b>1.3.4</b> Créer une matrice de distances</a></li>
<li class="chapter" data-level="1.3.5" data-path="chapitre1.html"><a href="chapitre1.html#agreger-des-polygones"><i class="fa fa-check"></i><b>1.3.5</b> Agréger des polygones</a></li>
<li class="chapter" data-level="1.3.6" data-path="chapitre1.html"><a href="chapitre1.html#agreger-des-polygones-en-fonction-dune-variable"><i class="fa fa-check"></i><b>1.3.6</b> Agréger des polygones en fonction d’une variable</a></li>
<li class="chapter" data-level="1.3.7" data-path="chapitre1.html"><a href="chapitre1.html#construire-une-zone-tampon"><i class="fa fa-check"></i><b>1.3.7</b> Construire une zone tampon</a></li>
<li class="chapter" data-level="1.3.8" data-path="chapitre1.html"><a href="chapitre1.html#realiser-une-intersection"><i class="fa fa-check"></i><b>1.3.8</b> Réaliser une intersection</a></li>
<li class="chapter" data-level="1.3.9" data-path="chapitre1.html"><a href="chapitre1.html#construire-des-polygones-de-voronoi"><i class="fa fa-check"></i><b>1.3.9</b> Construire des polygones de Voronoi</a></li>
<li class="chapter" data-level="1.3.10" data-path="chapitre1.html"><a href="chapitre1.html#exemple"><i class="fa fa-check"></i><b>1.3.10</b> Exemple</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapitre1.html"><a href="chapitre1.html#geocodage-dadresses"><i class="fa fa-check"></i><b>1.4</b> Géocodage d’adresses</a></li>
<li class="chapter" data-level="1.5" data-path="chapitre1.html"><a href="chapitre1.html#le-package-raster"><i class="fa fa-check"></i><b>1.5</b> Le package <code>raster</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre2.html"><a href="chapitre2.html"><i class="fa fa-check"></i><b>2</b> Cartographie thématique</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre2.html"><a href="chapitre2.html#le-package-cartography"><i class="fa fa-check"></i><b>2.1</b> Le package <code>cartography</code></a></li>
<li class="chapter" data-level="2.2" data-path="chapitre2.html"><a href="chapitre2.html#representations-usuelles"><i class="fa fa-check"></i><b>2.2</b> Représentations usuelles</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chapitre2.html"><a href="chapitre2.html#symboles-proportionnels"><i class="fa fa-check"></i><b>2.2.1</b> Symboles proportionnels</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapitre2.html"><a href="chapitre2.html#carte-choroplethe"><i class="fa fa-check"></i><b>2.2.2</b> Carte choroplèthe</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapitre2.html"><a href="chapitre2.html#elements-dhabillage"><i class="fa fa-check"></i><b>2.3</b> Éléments d’habillage</a></li>
<li class="chapter" data-level="2.4" data-path="chapitre2.html"><a href="chapitre2.html#palettes-de-couleurs"><i class="fa fa-check"></i><b>2.4</b> Palettes de couleurs</a></li>
<li class="chapter" data-level="2.5" data-path="chapitre2.html"><a href="chapitre2.html#discretisations"><i class="fa fa-check"></i><b>2.5</b> Discrétisations</a></li>
<li class="chapter" data-level="2.6" data-path="chapitre2.html"><a href="chapitre2.html#combinaisons"><i class="fa fa-check"></i><b>2.6</b> Combinaisons</a></li>
<li class="chapter" data-level="2.7" data-path="chapitre2.html"><a href="chapitre2.html#les-donnees-osm"><i class="fa fa-check"></i><b>2.7</b> Les données OSM</a><ul>
<li class="chapter" data-level="2.7.1" data-path="chapitre2.html"><a href="chapitre2.html#donnees-vectorielles"><i class="fa fa-check"></i><b>2.7.1</b> Données vectorielles</a></li>
<li class="chapter" data-level="2.7.2" data-path="chapitre2.html"><a href="chapitre2.html#donnees-raster"><i class="fa fa-check"></i><b>2.7.2</b> Données raster</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="chapitre2.html"><a href="chapitre2.html#creation-de-cartons"><i class="fa fa-check"></i><b>2.8</b> Création de cartons</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre3.html"><a href="chapitre3.html"><i class="fa fa-check"></i><b>3</b> Cartographie thématique avancée</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre3.html"><a href="chapitre3.html#cartographie-interactiv"><i class="fa fa-check"></i><b>3.1</b> Cartographie interactiv</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes"><i class="fa fa-check"></i><b>3.2</b> Les cartogrammes</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-de-dorling"><i class="fa fa-check"></i><b>3.2.1</b> Les cartogrammes de Dorling</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-non-continus"><i class="fa fa-check"></i><b>3.2.2</b> Les cartogrammes non continus</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapitre3.html"><a href="chapitre3.html#les-cartogrammes-continus"><i class="fa fa-check"></i><b>3.2.3</b> Les cartogrammes continus</a></li>
<li class="chapter" data-level="3.2.4" data-path="chapitre3.html"><a href="chapitre3.html#forces-et-faiblesses-des-cartogrammes"><i class="fa fa-check"></i><b>3.2.4</b> Forces et faiblesses des cartogrammes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapitre3.html"><a href="chapitre3.html#les-grilles-regulieres"><i class="fa fa-check"></i><b>3.3</b> Les grilles régulières</a></li>
<li class="chapter" data-level="3.4" data-path="chapitre3.html"><a href="chapitre3.html#les-cartes-de-discontinuites"><i class="fa fa-check"></i><b>3.4</b> Les cartes de discontinuités</a></li>
<li class="chapter" data-level="3.5" data-path="chapitre3.html"><a href="chapitre3.html#le-lissage-spatial"><i class="fa fa-check"></i><b>3.5</b> Le lissage spatial</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre3.html"><a href="chapitre3.html#kde"><i class="fa fa-check"></i><b>3.5.1</b> KDE</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre3.html"><a href="chapitre3.html#stewart"><i class="fa fa-check"></i><b>3.5.2</b> Stewart</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre3.html"><a href="chapitre3.html#d"><i class="fa fa-check"></i><b>3.6</b> 3D</a><ul>
<li class="chapter" data-level="3.6.1" data-path="chapitre3.html"><a href="chapitre3.html#linemap"><i class="fa fa-check"></i><b>3.6.1</b> linemap</a></li>
<li class="chapter" data-level="3.6.2" data-path="chapitre3.html"><a href="chapitre3.html#rayshader"><i class="fa fa-check"></i><b>3.6.2</b> rayshader</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i><b>4</b> <code>sessionInfo()</code></a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rCarto/carto_avec_r" target="blank">Contribuer</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cartographie avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre1" class="section level1">
<h1><span class="header-section-number">Chapitre 1</span> Les données spatiales</h1>
<p>Il est possible d’importer, de manipuler, de traiter, d’afficher et d’exporter des données spatiales avec R. La grande majorité des opérations de géotraitement sont disponible dans R grace au package <code>sf</code>. Il devient alors possible d’utiliser R comme un SIG.</p>
<div id="le-package-sf" class="section level2">
<h2><span class="header-section-number">1.1</span> Le package <code>sf</code></h2>
<p><strong>Historique</strong><br />
Historiquement trois packages permettent d’importer, de manipuler et de transformer les données spatiales :</p>
<ul>
<li>Le package <code>rgdal</code> qui est une interface entre R et les librairies GDAL (<a href="http://www.gdal.org/" target="_blank">Geospatial Data Abstraction Library</a>) et <a href="https://github.com/OSGeo/proj.4" target="_blank">PROJ4</a> permet d’importer et d’exporter les données spatiales (les shapefiles par exemple) et aussi de gérer les projections cartographiques<br />
</li>
<li>Le package <code>sp</code> fournit des classes et methodes pour les données spatiales dans R. C’est grace à ce package que l’on peut afficher des fond de cartes, inspecter une table attributaire etc.<br />
</li>
<li>Le package <code>rgeos</code> donne accès à la librairie d’opérations spatiales GEOS (<a href="http://trac.osgeo.org/geos/" target="_blank">Geometry Engine - Open Source</a>) et rend donc disponible les opérations SIG classiques : calcul de surface ou de périmètre, calcul de distances, aggrégations spatiales, zones tampons, intersections etc.</li>
</ul>
<p><strong>La suite</strong><br />
Le package <code>sf</code> a été publié fin 2016 par Edzer Pebesma (auteur de <code>sp</code>). Son objectif est de combiner dans les fonctionnalités de <code>sp</code>, <code>rgeos</code> et <code>rgdal</code> dans un package unique plus ergonomique.
Ce package propose des objets plus simples (suivant le standard simple feature) dont la manipulation est plus aisée. Une attention particulière a été portée à la compatibilité du package avec la syntaxe <em>pipe</em> et les opérateurs du <code>tidyverse</code>.</p>
<p>Aujourd’hui, les principaux développements dans l’écosystème spatial de R se détachent progressivement des 3 anciens (<code>sp</code>, <code>rgdal</code>, <code>rgeos</code>) pour se reposer sur <code>sf</code>.
Dans ce document nous utiliserons <code>sf</code> tant que cela est possible, c’està dire la plupart du temps.</p>
<div id="format-des-objets-spatiaux-sf" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Format des objets spatiaux <code>sf</code></h3>
<p><img src="img/sf.png" width="562" style="display: block; margin: auto;" /></p>
<p>Les objets <code>sf</code> sont des data.frame dont l’une des colonne contient des géométrie. Cette colonne est de la classe sfc (simple feature column) et chaque individu de la colonne est un sfg (simple feature geometry).<br />
Ce format très pratique dans la mesure ou les données et les géométries sont intrinsequement liées dans un même objet.</p>
</div>
<div id="construction-dun-objet-sf" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Construction d’un objet sf</h3>
<div id="couche-de-points" class="section level4">
<h4><span class="header-section-number">1.1.2.1</span> Couche de points</h4>
<pre class="sourceCode r"><code class="sourceCode r">pt1_sfg &lt;-<span class="st"> </span><span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
pt2_sfg &lt;-<span class="st"> </span><span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))
pt3_sfg &lt;-<span class="st"> </span><span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))
(pt_sfc &lt;-<span class="st"> </span><span class="kw">st_sfc</span>(pt1_sfg,pt2_sfg,pt3_sfg, <span class="dt">crs =</span> (<span class="dv">4326</span>)))</code></pre>
<pre><code>Geometry set for 3 features 
geometry type:  POINT
dimension:      XY
bbox:           xmin: 1 ymin: 1 xmax: 3 ymax: 4
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">pt_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">cat =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>), 
                   <span class="dt">var1 =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="dt">var2 =</span> <span class="kw">c</span>(<span class="fl">2.3</span>,<span class="fl">1.9</span>,<span class="dv">4</span>))
(pt_sf &lt;-<span class="st"> </span><span class="kw">st_sf</span>(pt_df,<span class="dt">geometry =</span> pt_sfc))</code></pre>
<pre><code>Simple feature collection with 3 features and 4 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 1 ymin: 1 xmax: 3 ymax: 4
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
  id cat var1 var2    geometry
1  1   A   10  2.3 POINT (1 2)
2  2   B   20  1.9 POINT (3 4)
3  3   A   30  4.0 POINT (2 1)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pt_sf)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="couche-de-polygones" class="section level4">
<h4><span class="header-section-number">1.1.2.2</span> Couche de polygones</h4>
<pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))
p2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">0</span>))
p3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))
pol1_sfg &lt;-<span class="kw">st_polygon</span>(<span class="kw">list</span>(p1))
pol2_sfg &lt;-<span class="kw">st_polygon</span>(<span class="kw">list</span>(p2))
pol3_sfg &lt;-<span class="kw">st_polygon</span>(<span class="kw">list</span>(p3))
(pol_sfc &lt;-<span class="st"> </span><span class="kw">st_sfc</span>(pol1_sfg, pol2_sfg, pol3_sfg, <span class="dt">crs =</span> <span class="dv">4326</span>))</code></pre>
<pre><code>Geometry set for 3 features 
geometry type:  POLYGON
dimension:      XY
bbox:           xmin: 0 ymin: 0 xmax: 4 ymax: 4
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">pol_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">cat =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>), 
                   <span class="dt">var1 =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="dt">var2 =</span> <span class="kw">c</span>(<span class="fl">2.3</span>,<span class="fl">1.9</span>,<span class="dv">4</span>))
(pol_sf &lt;-<span class="st"> </span><span class="kw">st_sf</span>(pol_df,<span class="dt">geometry =</span> pol_sfc))</code></pre>
<pre><code>Simple feature collection with 3 features and 4 fields
geometry type:  POLYGON
dimension:      XY
bbox:           xmin: 0 ymin: 0 xmax: 4 ymax: 4
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
  id cat var1 var2                       geometry
1  1   A   10  2.3 POLYGON ((0 0, 1 0, 3 2, 2 ...
2  2   B   20  1.9 POLYGON ((3 0, 4 0, 4 1, 3 ...
3  3   A   30  4.0 POLYGON ((3 3, 4 2, 4 3, 3 3))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pol_sf)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="couche-de-linestring" class="section level4">
<h4><span class="header-section-number">1.1.2.3</span> Couche de linestring</h4>
<pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))
p2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))
p3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))
ls1_sfg &lt;-<span class="kw">st_linestring</span>(p1)
ls2_sfg &lt;-<span class="kw">st_linestring</span>(p2)
ls3_sfg &lt;-<span class="kw">st_linestring</span>(p3)
(ls_sfc &lt;-<span class="st"> </span><span class="kw">st_sfc</span>(ls1_sfg, ls2_sfg, ls3_sfg, <span class="dt">crs =</span> <span class="dv">4326</span>))</code></pre>
<pre><code>Geometry set for 3 features 
geometry type:  LINESTRING
dimension:      XY
bbox:           xmin: 0 ymin: 0 xmax: 4 ymax: 4
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ls_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">cat =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>), 
                   <span class="dt">var1 =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>), <span class="dt">var2 =</span> <span class="kw">c</span>(<span class="fl">2.3</span>,<span class="fl">1.9</span>,<span class="dv">4</span>))
(ls_sf &lt;-<span class="st"> </span><span class="kw">st_sf</span>(ls_df,<span class="dt">geometry =</span> ls_sfc))</code></pre>
<pre><code>Simple feature collection with 3 features and 4 fields
geometry type:  LINESTRING
dimension:      XY
bbox:           xmin: 0 ymin: 0 xmax: 4 ymax: 4
epsg (SRID):    4326
proj4string:    +proj=longlat +datum=WGS84 +no_defs
  id cat var1 var2                       geometry
1  1   A   10  2.3 LINESTRING (0 0, 1 0, 3 2, ...
2  2   B   20  1.9 LINESTRING (3 0, 4 0, 4 1, ...
3  3   A   30  4.0     LINESTRING (3 3, 4 2, 4 3)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ls_sf)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
<div id="import-export" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Import / Export</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sf)
mtq &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/martinique.shp&quot;</span>)</code></pre>
<pre><code>Reading layer `martinique&#39; from data source `/home/tim/Documents/prz/Cartographie_avec_R/data/martinique.shp&#39; using driver `ESRI Shapefile&#39;
Simple feature collection with 34 features and 23 fields
geometry type:  POLYGON
dimension:      XY
bbox:           xmin: 690574.4 ymin: 1592426 xmax: 736126.5 ymax: 1645660
epsg (SRID):    32620
proj4string:    +proj=utm +zone=20 +datum=WGS84 +units=m +no_defs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_write</span>(<span class="dt">obj =</span> mtq, <span class="dt">dsn =</span> <span class="st">&quot;data/mtq.gpkg&quot;</span>, <span class="dt">layer =</span> <span class="st">&quot;mtq&quot;</span>, <span class="dt">delete_layer =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>Deleting layer `mtq&#39; failed
Updating layer `mtq&#39; to data source `data/mtq.gpkg&#39; using driver `GPKG&#39;
features:       34
fields:         23
geometry type:  Polygon</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">st_write</span>(<span class="dt">obj =</span> mtq, <span class="st">&quot;data/mtq.shp&quot;</span>, <span class="dt">delete_layer =</span> T)</code></pre>
<pre><code>Writing layer `mtq&#39; to data source `data/mtq.shp&#39; using driver `ESRI Shapefile&#39;
features:       34
fields:         23
geometry type:  Polygon</code></pre>
</div>
<div id="affichage-de-donnees" class="section level3">
<h3><span class="header-section-number">1.1.4</span> Affichage de données</h3>
<p>Aperçu des variables</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mtq)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/unnamed-chunk-5-1.png" width="288" /></p>
<p>Affichage de la géométrie</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq))</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/unnamed-chunk-6-1.png" width="288" /></p>
</div>
<div id="joindre-des-donnees" class="section level3">
<h3><span class="header-section-number">1.1.5</span> Joindre des données</h3>
</div>
</div>
<div id="les-projections" class="section level2">
<h2><span class="header-section-number">1.2</span> Les projections</h2>
</div>
<div id="operations-de-geotraitement" class="section level2">
<h2><span class="header-section-number">1.3</span> Opérations de géotraitement</h2>
<div id="selection-par-attributs" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Selection par attributs</h3>
</div>
<div id="selection-spatiale" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Selection spatiale</h3>
</div>
<div id="extraire-des-centroides" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Extraire des centroides</h3>
<pre class="sourceCode r"><code class="sourceCode r">mtq_c &lt;-<span class="st"> </span><span class="kw">st_centroid</span>(mtq)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq))
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_c), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/centroid-1.png" width="288" /></p>
</div>
<div id="creer-une-matrice-de-distances" class="section level3">
<h3><span class="header-section-number">1.3.4</span> Créer une matrice de distances</h3>
<pre class="sourceCode r"><code class="sourceCode r">mat &lt;-<span class="st"> </span><span class="kw">st_distance</span>(<span class="dt">x=</span>mtq_c,<span class="dt">y=</span>mtq_c)
mat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre>
<pre><code>Units: [m]
          [,1]     [,2]      [,3]      [,4]      [,5]
[1,]     0.000 35297.56  3091.501 12131.617 17136.310
[2,] 35297.557     0.00 38332.602 25518.913 18605.249
[3,]  3091.501 38332.60     0.000 15094.702 20226.198
[4,] 12131.617 25518.91 15094.702     0.000  7177.011
[5,] 17136.310 18605.25 20226.198  7177.011     0.000</code></pre>
</div>
<div id="agreger-des-polygones" class="section level3">
<h3><span class="header-section-number">1.3.5</span> Agréger des polygones</h3>
<pre class="sourceCode r"><code class="sourceCode r">mtq_u &lt;-<span class="st"> </span><span class="kw">st_union</span>(mtq)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_u), <span class="dt">add=</span>T, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/aggreg-1.png" width="288" /></p>
</div>
<div id="agreger-des-polygones-en-fonction-dune-variable" class="section level3">
<h3><span class="header-section-number">1.3.6</span> Agréger des polygones en fonction d’une variable</h3>
</div>
<div id="construire-une-zone-tampon" class="section level3">
<h3><span class="header-section-number">1.3.7</span> Construire une zone tampon</h3>
<pre class="sourceCode r"><code class="sourceCode r">mtq_b &lt;-<span class="st"> </span><span class="kw">st_buffer</span>(<span class="dt">x =</span> mtq_u, <span class="dt">dist =</span> <span class="dv">2000</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq), <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_u), <span class="dt">add=</span>T, <span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_b), <span class="dt">add=</span>T, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/buffers-1.png" width="288" /></p>
</div>
<div id="realiser-une-intersection" class="section level3">
<h3><span class="header-section-number">1.3.8</span> Réaliser une intersection</h3>
<pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">700015</span>,<span class="dv">1624212</span>), <span class="kw">c</span>(<span class="dv">700015</span>,<span class="dv">1641586</span>), <span class="kw">c</span>(<span class="dv">719127</span>,<span class="dv">1641586</span>), <span class="kw">c</span>(<span class="dv">719127</span>,<span class="dv">1624212</span>), <span class="kw">c</span>(<span class="dv">700015</span>,<span class="dv">1624212</span>))
p &lt;-<span class="st"> </span><span class="kw">st_sf</span>(<span class="kw">st_sfc</span>(<span class="kw">st_polygon</span>(<span class="kw">list</span>(m))), <span class="dt">crs =</span> <span class="kw">st_crs</span>(mtq))
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq))
<span class="kw">plot</span>(p, <span class="dt">border=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">add=</span>T)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/intersect-1.png" width="288" /></p>
<pre class="sourceCode r"><code class="sourceCode r">mtq_z &lt;-<span class="st"> </span><span class="kw">st_intersection</span>(<span class="dt">x =</span> mtq, <span class="dt">y =</span> p)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq))
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_z), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">border=</span><span class="st">&quot;green&quot;</span>, <span class="dt">add=</span>T)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/intersect-2.png" width="288" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_z))</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/intersect-3.png" width="288" /></p>
</div>
<div id="construire-des-polygones-de-voronoi" class="section level3">
<h3><span class="header-section-number">1.3.9</span> Construire des polygones de Voronoi</h3>
<p>google: “st_voronoi R sf” (<a href="https://github.com/r-spatial/sf/issues/474" class="uri">https://github.com/r-spatial/sf/issues/474</a> &amp; <a href="https://stackoverflow.com/questions/45719790/create-voronoi-polygon-with-simple-feature-in-r" class="uri">https://stackoverflow.com/questions/45719790/create-voronoi-polygon-with-simple-feature-in-r</a>)</p>
<pre class="sourceCode r"><code class="sourceCode r">mtq_v &lt;-<span class="st"> </span><span class="kw">st_voronoi</span>(<span class="dt">x =</span> <span class="kw">st_union</span>(mtq_c))
mtq_v &lt;-<span class="st"> </span><span class="kw">st_intersection</span>(<span class="kw">st_cast</span>(mtq_v), <span class="kw">st_union</span>(mtq))
mtq_v &lt;-<span class="st"> </span><span class="kw">st_join</span>(<span class="dt">x =</span> <span class="kw">st_sf</span>(mtq_v), <span class="dt">y =</span> mtq_c, <span class="dt">join=</span>st_intersects)
mtq_v &lt;-<span class="st"> </span><span class="kw">st_cast</span>(mtq_v, <span class="st">&quot;MULTIPOLYGON&quot;</span>)
<span class="kw">plot</span>(<span class="kw">st_geometry</span>(mtq_v), <span class="dt">col=</span><span class="st">&#39;lightblue&#39;</span>)</code></pre>
<p><img src="Cartographie_avec_R_files/figure-html/voronoi-1.png" width="288" /></p>
</div>
<div id="exemple" class="section level3">
<h3><span class="header-section-number">1.3.10</span> Exemple</h3>
<p>Découpe d’une zone par un polygone</p>
</div>
</div>
<div id="geocodage-dadresses" class="section level2">
<h2><span class="header-section-number">1.4</span> Géocodage d’adresses</h2>
</div>
<div id="le-package-raster" class="section level2">
<h2><span class="header-section-number">1.5</span> Le package <code>raster</code></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapitre2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Cartographie_avec_R.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
